(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{380:function(t,e,n){"use strict";n.r(e);var a=n(27),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"page-title"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[t._v("#")]),t._v(" "+t._s(t.$page.title))]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523452-fc776d00-a284-11eb-8eb1-49ebb0565272.gif",alt:"logo"}})]),t._v(" "),n("p",[n("span",{staticStyle:{color:"#999"}},[t._v(t._s(t.$page.readingTime.text)+"...")])]),t._v(" "),n("h2",{attrs:{id:"foreword"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#foreword"}},[t._v("#")]),t._v(" Foreword")]),t._v(" "),n("p",[t._v("16Shop is not especially new in the world of phishing kits. It's been written about before, analysed many times over and has even been cracked and ripped to shreds by other threat actors within the phishing community.")]),t._v(" "),n("p",[t._v('However, it\'s still arguably the most popular and successful "Phishing-as-a-service" (PaaS) kits around and it is constantly evolving, making it an interesting phish to try and catch. ðŸŽ£')]),t._v(" "),n("p",[t._v("This article will cover a lot regarding 16Shop including its origins, change over time, a deep-dive in to how the kit works and other interesting artefacts which can be used to help you hunt 16Shop.")]),t._v(" "),n("p",[t._v("For a live feed of 16Shop detections as well as other popular PaaS kits, please take a look at "),n("a",{attrs:{href:"https://phishingreel.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("phishingreel.io"),n("OutboundLink")],1),t._v(". (Full disclosure, PhishingReel was developed by myself and is now being maintained by "),n("a",{attrs:{href:"https://twitter.com/thumbscrw",target:"_blank",rel:"noopener noreferrer"}},[t._v("@thumbscrw"),n("OutboundLink")],1),t._v(")")]),t._v(" "),n("h2",{attrs:{id:"background"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[t._v("#")]),t._v(" Background")]),t._v(" "),n("h3",{attrs:{id:"_16what"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16what"}},[t._v("#")]),t._v(" 16what?")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://media.giphy.com/media/ybcMkow8xLIrK/giphy.gif",alt:"wha?"}})]),t._v(" "),n("p",[t._v("16Shop is the name of a sophisticated Phishing kit distribution network, designed  for malicious actors to quickly and easily set up believable phishing pages targeting popular brands. As these kits are provided as a service, the individuals buying and using 16Shop do not need to be skilled, thus widening the net for potential customers.")]),t._v(" "),n("h3",{attrs:{id:"evolution"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#evolution"}},[t._v("#")]),t._v(" Evolution")]),t._v(" "),n("p",[t._v("16Shop has been around for some time now, with articles reporting on the kit since late 2018. However it's likely 16Shop has been around for longer than this, with public discussions taking place in early 2018. This indicates the kit was likely being sold for a period before then.")]),t._v(" "),n("p",[t._v("Originally 16Shop targeted only Apple and contained language localisation for Japan and the US, eventually adding more language options as time went on.Lures were in the form of phishing emails purporting to be from Apple, asking the user to confirm their login details and follow the link within an attached PDF document.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://www.mcafee.com/wp-content/uploads/2019/07/email-2.png",alt:""}}),t._v(" "),n("img",{attrs:{src:"https://www.mcafee.com/wp-content/uploads/2019/07/phishing-pdf.png",alt:""}}),t._v(" "),n("em",[t._v("Images courtesy of McAfee")])]),t._v(" "),n("p",[t._v("Just ahead of Amazon Prime day 2019 "),n("a",{attrs:{href:"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/16shop-now-targets-amazon/",target:"_blank",rel:"noopener noreferrer"}},[t._v("McAfee"),n("OutboundLink")],1),t._v(" discovered a new version of 16Shop targeting Amazon which quickly gained popularity, clearly trying to cash in on the hype around the upcoming Amazon Prime day.")]),t._v(" "),n("p",[t._v("Later, around Jan 2020 "),n("a",{attrs:{href:"https://www.zerofox.com/blog/16shop-adds-paypal-american-express-to-their-catalog/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ZeroFox"),n("OutboundLink")],1),t._v(" reported 16Shop had added kits targeting PayPal and AMEX to their available products, further diversifying their range of targets.")]),t._v(" "),n("h3",{attrs:{id:"author"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#author"}},[t._v("#")]),t._v(" Author")]),t._v(" "),n("p",[t._v('Early versions of the kit contained code comments and artefacts attributing the creation of 16Shop to the alias "devilscream"')]),t._v(" "),n("p",[n("img",{attrs:{src:"https://www.mcafee.com/wp-content/uploads/2019/07/tags.png",alt:""}}),n("br"),t._v(" "),n("em",[t._v("Images courtesy of McAfee")])]),t._v(" "),n("blockquote",[n("p",[t._v("Devil Scream or Devils Cream?")])]),t._v(" "),n("p",[t._v('Through OSINT sources the alias DevilScreaM was publicly attributed to "Riswanda" from Indonesia. He has been previously responsible for defacing vulnerable Wordpress sites and later on producing tools and exploits for malicious activity. He is also an active member of the cyber crime gang "Indonesian Cyber Army".')]),t._v(" "),n("blockquote",{staticClass:"twitter-tweet",attrs:{align:"center"}},[n("p",{attrs:{lang:"en",dir:"ltr",align:"center"}},[t._v("The "),n("a",{attrs:{href:"https://twitter.com/Apple?ref_src=twsrc%5Etfw"}},[t._v("@Apple")]),t._v(" "),n("a",{attrs:{href:"https://twitter.com/hashtag/Phishing?src=hash&ref_src=twsrc%5Etfw"}},[t._v("#Phishing")]),t._v(" kit author 'devilscream' does a bad job of hiding his identity (or a good job of inventing a fake one)."),n("br"),n("br"),t._v("He won a website design competition in early 2017 and is pictured below with his mother. I doubt she would be very proud of his most recent work. "),n("a",{attrs:{href:"https://t.co/FUx8dezwWe"}},[t._v("pic.twitter.com/FUx8dezwWe")])]),t._v("â€” Phishing AI (@PhishingAi) "),n("a",{attrs:{href:"https://twitter.com/PhishingAi/status/1011688773610979328?ref_src=twsrc%5Etfw"}},[t._v("June 26, 2018")])]),t._v(" "),n("script",{attrs:{async:"",src:"https://platform.twitter.com/widgets.js",charset:"utf-8"}}),t._v(" "),n("h3",{attrs:{id:"cracked-kits"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cracked-kits"}},[t._v("#")]),t._v(" Cracked Kits")]),t._v(" "),n("p",[t._v('Unsurprisingly, in the criminal realm of phishing not everyone wants to pay for a service like 16Shop and instead simply "crack" the kit\'s validation methods in order to use the kit free of charge.')]),t._v(" "),n("p",[t._v("There are many versions of cracked 16Shop kits floating around, most notably a version discovered recently by "),n("a",{attrs:{href:"https://blogs.akamai.com/sitr/2019/05/16shop-commercial-phishing-kit-has-a-hidden-backdoor.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Akamai"),n("OutboundLink")],1),t._v(" which included a backdoor, allowing the individual who distributed the cracked version to obtain a copy of all victim credentials sent to a telegram bot under their control.")]),t._v(" "),n("p",[t._v("16Shop code has also been taken and included within other popular PaaS kits recently such as FreakzBrothers kits, and also even been completely rebranded and distributed without any reference to its original source.")]),t._v(" "),n("h2",{attrs:{id:"distribution"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#distribution"}},[t._v("#")]),t._v(" Distribution")]),t._v(" "),n("p",[t._v("Similarly to other PaaS kits, 16Shop is sold through an online store where individuals can register and purchase the kit in its various forms for fixed prices set by the author.")]),t._v(" "),n("h3",{attrs:{id:"storefront"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#storefront"}},[t._v("#")]),t._v(" Storefront")]),t._v(" "),n("p",[t._v('The online store offers a glimpse at what is available for purchase, and prompts visitors to either sign in or register to access the "member" area.')]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115518271-e1562e80-a27f-11eb-8090-47c8d50e6af0.png",alt:"16shop-store-1"}})]),t._v(" "),n("p",[t._v("Current targets include Apple, Amazon, PayPal and AMEX (the broken image link references the AMEX logo). The copyright would also indicate the kit has been for sale since before it started showing up on researcher's radars.")]),t._v(" "),n("p",[t._v("The member login area offers further information on what is available for purchase, showing prices for the various kits along with user guides on how to install and configure them.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115518314-eca95a00-a27f-11eb-908b-1ccd92977d59.png",alt:"member-prices"}})]),t._v(" "),n("p",[t._v('The "shortlink" service is a recent addition, offering something akin to bit.ly in order to obfuscate phishing URL\'s being sent to potential victims and further control how these victims can access and interact with the phishing page.')]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115518351-f763ef00-a27f-11eb-8900-f956007a1730.png",alt:"shortlink"}})]),t._v(" "),n("p",[t._v('Other pages allow access to tools such as credential validators, IP reputation checkers and obfuscation tools which can all be used by "customers".')]),t._v(" "),n("h3",{attrs:{id:"following-the-money"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#following-the-money"}},[t._v("#")]),t._v(" Following the money")]),t._v(" "),n("p",[t._v("Taking a look at the payment options again we can see there are 3 options available:")]),t._v(" "),n("ol",[n("li",[t._v("Bank transfer (only available within Indonesia)")]),t._v(" "),n("li",[t._v("Bitcoin")]),t._v(" "),n("li",[t._v("Litecoin\nSelecting the bitcoin option presents us with a btc address of "),n("code",[t._v("1NyjuDCFpwEuzuWWAZWqt94maZSuTddx3P")]),t._v(" to send payment to."),n("br"),t._v("\nThis particular address has been active since mid 2018 and to date has had 949 transactions totalling almost 3.6 BTC/$40k USD.")])]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115518480-1cf0f880-a280-11eb-8fd3-160ad49506dd.png",alt:"btcwallet"}}),t._v(" "),n("a",{attrs:{href:"https://www.blockchain.com/btc/address/1NyjuDCFpwEuzuWWAZWqt94maZSuTddx3P",target:"_blank",rel:"noopener noreferrer"}},[t._v("Wallet history"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("Practically all funds that go in to this wallet are shortly thereafter transferred out to another wallet believed to be owned by a cryptocurrency exchange (which would explain the numbers!). This wallet (as of writing) holds approx 27.6 BTC/$303k USD")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115518535-2e3a0500-a280-11eb-9b9f-c84736703595.png",alt:"2ndwallet"}}),t._v(" "),n("a",{attrs:{href:"https://www.blockchain.com/btc/address/1JUToCyRL5UwgeucjnFAagKs4v1YqhjT1d",target:"_blank",rel:"noopener noreferrer"}},[t._v("Wallet history"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("The litecoin wallet "),n("code",[t._v("MHg1zYpLNrsRWkb5nGSAWvLeStdamKJ8AA")]),t._v(" tells a similar tale. So far netting around a modest 12 LTC, which has subsequently been transferred to another wallet which held 129,233 LTC.")]),t._v(" "),n("h2",{attrs:{id:"_16shop-dissection"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16shop-dissection"}},[t._v("#")]),t._v(" 16Shop Dissection")]),t._v(" "),n("p",[t._v("This section will cover a lot of in-depth information pertaining to how the kit works, the information obtained from victims, how it avoids detection and reversing the source code and functionality of the kit.")]),t._v(" "),n("p",[t._v("Not all kits will necessarily function the same as below, as each targeted brand has their own unique elements. However as the latest addition to the 16Shop portfolio is AMEX, we'll be taking a look at this kit.")]),t._v(" "),n("h3",{attrs:{id:"directory-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#directory-structure"}},[t._v("#")]),t._v(" Directory structure")]),t._v(" "),n("p",[t._v("Just so we all know what we are working with here, here is the structure of the AMEX kit.")]),t._v(" "),n("details",[n("summary",[t._v("tree output (long!)")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("16Shop-Amex-New-V1.zip.\n|   .DS_Store\n|   .htaccess\n|   antibot.ini\n|   antibot.php\n|   blacklist.php\n|   blocker.php\n|   crawlerdetect.php\n|   index.php\n|   load.php\n|   main.php\n|   onetime.php\n|   proxyblock.php\n|   server.ini\n|\n+---admin\n|   |   .DS_Store\n|   |   antibot.php\n|   |   bot.php\n|   |   index.php\n|   |   login.php\n|   |   logout.php\n|   |   reset.php\n|   |   visitor.php\n|   |\n|   +---css\n|   |       font-face.css\n|   |       theme.css\n|   |\n|   +---fonts\n|   |   \\---poppins\n|   |           poppins-v5-latin-100.eot\n|   |           poppins-v5-latin-100.svg\n|   |           poppins-v5-latin-100.ttf\n|   |           poppins-v5-latin-100.woff\n|   |           poppins-v5-latin-100.woff2\n|   |           poppins-v5-latin-100italic.eot\n|   |           poppins-v5-latin-100italic.svg\n|   |           poppins-v5-latin-100italic.ttf\n|   |           poppins-v5-latin-100italic.woff\n|   |           poppins-v5-latin-100italic.woff2\n|   |           poppins-v5-latin-200.eot\n|   |           poppins-v5-latin-200.svg\n|   |           poppins-v5-latin-200.ttf\n|   |           poppins-v5-latin-200.woff\n|   |           poppins-v5-latin-200.woff2\n|   |           poppins-v5-latin-200italic.eot\n|   |           poppins-v5-latin-200italic.svg\n|   |           poppins-v5-latin-200italic.ttf\n|   |           poppins-v5-latin-200italic.woff\n|   |           poppins-v5-latin-200italic.woff2\n|   |           poppins-v5-latin-300.eot\n|   |           poppins-v5-latin-300.svg\n|   |           poppins-v5-latin-300.ttf\n|   |           poppins-v5-latin-300.woff\n|   |           poppins-v5-latin-300.woff2\n|   |           poppins-v5-latin-300italic.eot\n|   |           poppins-v5-latin-300italic.svg\n|   |           poppins-v5-latin-300italic.ttf\n|   |           poppins-v5-latin-300italic.woff\n|   |           poppins-v5-latin-300italic.woff2\n|   |           poppins-v5-latin-500.eot\n|   |           poppins-v5-latin-500.svg\n|   |           poppins-v5-latin-500.ttf\n|   |           poppins-v5-latin-500.woff\n|   |           poppins-v5-latin-500.woff2\n|   |           poppins-v5-latin-500italic.eot\n|   |           poppins-v5-latin-500italic.svg\n|   |           poppins-v5-latin-500italic.ttf\n|   |           poppins-v5-latin-500italic.woff\n|   |           poppins-v5-latin-500italic.woff2\n|   |           poppins-v5-latin-600.eot\n|   |           poppins-v5-latin-600.svg\n|   |           poppins-v5-latin-600.ttf\n|   |           poppins-v5-latin-600.woff\n|   |           poppins-v5-latin-600.woff2\n|   |           poppins-v5-latin-600italic.eot\n|   |           poppins-v5-latin-600italic.svg\n|   |           poppins-v5-latin-600italic.ttf\n|   |           poppins-v5-latin-600italic.woff\n|   |           poppins-v5-latin-600italic.woff2\n|   |           poppins-v5-latin-700.eot\n|   |           poppins-v5-latin-700.svg\n|   |           poppins-v5-latin-700.ttf\n|   |           poppins-v5-latin-700.woff\n|   |           poppins-v5-latin-700.woff2\n|   |           poppins-v5-latin-700italic.eot\n|   |           poppins-v5-latin-700italic.svg\n|   |           poppins-v5-latin-700italic.ttf\n|   |           poppins-v5-latin-700italic.woff\n|   |           poppins-v5-latin-700italic.woff2\n|   |           poppins-v5-latin-800.eot\n|   |           poppins-v5-latin-800.svg\n|   |           poppins-v5-latin-800.ttf\n|   |           poppins-v5-latin-800.woff\n|   |           poppins-v5-latin-800.woff2\n|   |           poppins-v5-latin-800italic.eot\n|   |           poppins-v5-latin-800italic.svg\n|   |           poppins-v5-latin-800italic.ttf\n|   |           poppins-v5-latin-800italic.woff\n|   |           poppins-v5-latin-800italic.woff2\n|   |           poppins-v5-latin-900.eot\n|   |           poppins-v5-latin-900.svg\n|   |           poppins-v5-latin-900.ttf\n|   |           poppins-v5-latin-900.woff\n|   |           poppins-v5-latin-900.woff2\n|   |           poppins-v5-latin-900italic.eot\n|   |           poppins-v5-latin-900italic.svg\n|   |           poppins-v5-latin-900italic.ttf\n|   |           poppins-v5-latin-900italic.woff\n|   |           poppins-v5-latin-900italic.woff2\n|   |           poppins-v5-latin-italic.eot\n|   |           poppins-v5-latin-italic.svg\n|   |           poppins-v5-latin-italic.ttf\n|   |           poppins-v5-latin-italic.woff\n|   |           poppins-v5-latin-italic.woff2\n|   |           poppins-v5-latin-regular.eot\n|   |           poppins-v5-latin-regular.svg\n|   |           poppins-v5-latin-regular.ttf\n|   |           poppins-v5-latin-regular.woff\n|   |           poppins-v5-latin-regular.woff2\n|   |\n|   +---images\n|   |   |   bg-title-01.jpg\n|   |   |   bg-title-02.jpg\n|   |   |\n|   |   \\---icon\n|   |           avatar-01.jpg\n|   |           avatar-02.jpg\n|   |           avatar-03.jpg\n|   |           avatar-04.jpg\n|   |           avatar-05.jpg\n|   |           avatar-06.jpg\n|   |           avatar-big-01.jpg\n|   |           logo-blue.png\n|   |           logo-mini.png\n|   |           logo-white.png\n|   |           logo.png\n|   |           Untitled-1.jpg\n|   |\n|   +---js\n|   |       main.js\n|   |\n|   \\---vendor\n|       |   jquery-3.2.1.min.js\n|       |   jquery-ui.min.js\n|       |\n|       +---animsition\n|       |       animsition.min.css\n|       |       animsition.min.js\n|       |\n|       +---bootstrap-4.1\n|       |       bootstrap.min.css\n|       |       bootstrap.min.js\n|       |       popper.min.js\n|       |\n|       +---bootstrap-progressbar\n|       |       bootstrap-progressbar-3.3.4.min.css\n|       |       bootstrap-progressbar.min.js\n|       |\n|       +---chartjs\n|       |       Chart.bundle.min.js\n|       |\n|       +---circle-progress\n|       |       circle-progress.js\n|       |       circle-progress.min.js\n|       |\n|       +---countdown\n|       |       countdowntime.js\n|       |       jquery.countdown.min.js\n|       |       moment-timezone-with-data.min.js\n|       |       moment-timezone.min.js\n|       |       moment.min.js\n|       |\n|       +---counter-up\n|       |       jquery.counterup.min.js\n|       |       jquery.waypoints.min.js\n|       |       waypoints.min.js\n|       |\n|       +---css-hamburgers\n|       |       hamburgers.css\n|       |       hamburgers.min.css\n|       |\n|       +---font-awesome-4.7\n|       |   |   HELP-US-OUT.txt\n|       |   |\n|       |   +---css\n|       |   |       font-awesome.css\n|       |   |       font-awesome.min.css\n|       |   |\n|       |   \\---fonts\n|       |           fontawesome-webfont.eot\n|       |           fontawesome-webfont.svg\n|       |           fontawesome-webfont.ttf\n|       |           fontawesome-webfont.woff\n|       |           fontawesome-webfont.woff2\n|       |           FontAwesome.otf\n|       |\n|       +---font-awesome-5\n|       |   +---css\n|       |   |       fontawesome-all.min.css\n|       |   |\n|       |   \\---webfonts\n|       |           fa-brands-400.eot\n|       |           fa-brands-400.svg\n|       |           fa-brands-400.ttf\n|       |           fa-brands-400.woff\n|       |           fa-brands-400.woff2\n|       |           fa-regular-400.eot\n|       |           fa-regular-400.svg\n|       |           fa-regular-400.ttf\n|       |           fa-regular-400.woff\n|       |           fa-regular-400.woff2\n|       |           fa-solid-900.eot\n|       |           fa-solid-900.svg\n|       |           fa-solid-900.ttf\n|       |           fa-solid-900.woff\n|       |           fa-solid-900.woff2\n|       |\n|       +---fullcalendar-3.10.0\n|       |   |   CHANGELOG.txt\n|       |   |   CONTRIBUTING.txt\n|       |   |   fullcalendar.css\n|       |   |   fullcalendar.js\n|       |   |   fullcalendar.min.css\n|       |   |   fullcalendar.min.js\n|       |   |   fullcalendar.print.css\n|       |   |   fullcalendar.print.min.css\n|       |   |   gcal.js\n|       |   |   gcal.min.js\n|       |   |   LICENSE.txt\n|       |   |   locale-all.js\n|       |   |   README.txt\n|       |   |\n|       |   +---lib\n|       |   |       moment.min.js\n|       |   |\n|       |   \\---locale\n|       |           af.js\n|       |           ar-dz.js\n|       |           ar-kw.js\n|       |           ar-ly.js\n|       |           ar-ma.js\n|       |           ar-sa.js\n|       |           ar-tn.js\n|       |           ar.js\n|       |           be.js\n|       |           bg.js\n|       |           bs.js\n|       |           ca.js\n|       |           cs.js\n|       |           da.js\n|       |           de-at.js\n|       |           de-ch.js\n|       |           de.js\n|       |           el.js\n|       |           en-au.js\n|       |           en-ca.js\n|       |           en-gb.js\n|       |           en-ie.js\n|       |           en-nz.js\n|       |           es-do.js\n|       |           es-us.js\n|       |           es.js\n|       |           et.js\n|       |           eu.js\n|       |           fa.js\n|       |           fi.js\n|       |           fr-ca.js\n|       |           fr-ch.js\n|       |           fr.js\n|       |           gl.js\n|       |           he.js\n|       |           hi.js\n|       |           hr.js\n|       |           hu.js\n|       |           id.js\n|       |           is.js\n|       |           it.js\n|       |           ja.js\n|       |           ka.js\n|       |           kk.js\n|       |           ko.js\n|       |           lb.js\n|       |           lt.js\n|       |           lv.js\n|       |           mk.js\n|       |           ms-my.js\n|       |           ms.js\n|       |           nb.js\n|       |           nl-be.js\n|       |           nl.js\n|       |           nn.js\n|       |           pl.js\n|       |           pt-br.js\n|       |           pt.js\n|       |           ro.js\n|       |           ru.js\n|       |           sk.js\n|       |           sl.js\n|       |           sq.js\n|       |           sr-cyrl.js\n|       |           sr.js\n|       |           sv.js\n|       |           th.js\n|       |           tr.js\n|       |           uk.js\n|       |           vi.js\n|       |           zh-cn.js\n|       |           zh-hk.js\n|       |           zh-tw.js\n|       |\n|       +---lightbox2\n|       |   +---dist\n|       |   |   +---css\n|       |   |   |       lightbox.css\n|       |   |   |\n|       |   |   +---images\n|       |   |   |       close.png\n|       |   |   |       loading.gif\n|       |   |   |       next.png\n|       |   |   |       prev.png\n|       |   |   |\n|       |   |   \\---js\n|       |   |           lightbox-plus-jquery.js\n|       |   |           lightbox-plus-jquery.min.js\n|       |   |           lightbox-plus-jquery.min.map\n|       |   |           lightbox.js\n|       |   |           lightbox.min.js\n|       |   |           lightbox.min.map\n|       |   |\n|       |   \\---src\n|       |       +---css\n|       |       |       lightbox.css\n|       |       |\n|       |       +---images\n|       |       |       close.png\n|       |       |       loading.gif\n|       |       |       next.png\n|       |       |       prev.png\n|       |       |\n|       |       \\---js\n|       |               lightbox.js\n|       |\n|       +---mdi-font\n|       |   +---css\n|       |   |       material-design-iconic-font.css\n|       |   |       material-design-iconic-font.min.css\n|       |   |\n|       |   \\---fonts\n|       |           Material-Design-Iconic-Font.eot\n|       |           Material-Design-Iconic-Font.svg\n|       |           Material-Design-Iconic-Font.ttf\n|       |           Material-Design-Iconic-Font.woff\n|       |           Material-Design-Iconic-Font.woff2\n|       |\n|       +---perfect-scrollbar\n|       |       perfect-scrollbar.css\n|       |       perfect-scrollbar.js\n|       |       perfect-scrollbar.min.js\n|       |\n|       +---progressbar\n|       |       progressbar.js\n|       |       progressbar.min.js\n|       |\n|       +---select2\n|       |       select2.min.css\n|       |       select2.min.js\n|       |\n|       +---slick\n|       |   |   ajax-loader.gif\n|       |   |   config.rb\n|       |   |   slick-theme.css\n|       |   |   slick-theme.less\n|       |   |   slick-theme.scss\n|       |   |   slick.css\n|       |   |   slick.js\n|       |   |   slick.less\n|       |   |   slick.min.js\n|       |   |   slick.scss\n|       |   |\n|       |   \\---fonts\n|       |           slick.eot\n|       |           slick.svg\n|       |           slick.ttf\n|       |           slick.woff\n|       |\n|       +---smk-accordion\n|       |       accordion.css\n|       |       accordion.js\n|       |       accordion.min.js\n|       |\n|       +---sweetalert\n|       |       sweetalert.min.js\n|       |\n|       +---vector-map\n|       |       jquery.vmap.brazil.js\n|       |       jquery.vmap.europe.js\n|       |       jquery.vmap.france.js\n|       |       jquery.vmap.germany.js\n|       |       jquery.vmap.js\n|       |       jquery.vmap.min.js\n|       |       jquery.vmap.russia.js\n|       |       jquery.vmap.sampledata.js\n|       |       jquery.vmap.usa.js\n|       |       jquery.vmap.world.js\n|       |       jqvmap.min.css\n|       |\n|       \\---wow\n|               animate.css\n|               wow.min.js\n|\n+---CrawlerDetect\n|   |   .DS_Store\n|   |   CrawlerDetect.php\n|   |   ReferralSpamDetect.php\n|   |\n|   \\---Fixtures\n|           AbstractProvider.php\n|           AbstractReff.php\n|           Crawlers.php\n|           Exclusions.php\n|           Headers.php\n|           Headerspam.php\n|           SpamReferrers.php\n|\n+---myca\n|   |   .DS_Store\n|   |   .htaccess\n|   |   done.php\n|   |   index.php\n|   |   link_email.php\n|   |   login.php\n|   |   session.php\n|   |   submit_email.php\n|   |   submit_verification.php\n|   |   verification.php\n|   |   verification_payment.php\n|   |\n|   \\---img\n|           amex_generic_img.gif\n|           BlueCashEveryday.png\n|           icon-gear.gif\n|           img-cardart-bce.png\n|           iNav_sprite_footer.gif\n|           logo_bluebox_1x.gif\n|           mobile_myca_300x250.gif\n|\n+---result\n|       index.php\n|\n\\---security\n        blacklist.dat\n        index.php\n        onetime.dat\n        whitelist.dat\n")])])])]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("There are a lot of resources within this kit, however the more interesting directories we'll be focusing on are;")]),t._v(" "),n("ul",[n("li",[t._v("The root directory")]),t._v(" "),n("li",[n("code",[t._v("admin")])]),t._v(" "),n("li",[n("code",[t._v("security")])]),t._v(" "),n("li",[n("code",[t._v("myca")])])]),t._v(" "),n("h3",{attrs:{id:"avoiding-detection"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#avoiding-detection"}},[t._v("#")]),t._v(" Avoiding detection")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://media.giphy.com/media/QA88yMhazfDI4/giphy.gif",alt:""}})]),t._v(" "),n("p",[t._v("16Shop kits utilise several methods to attempt and evade detection which may prompt a takedown of their deployment. Some of these controls are further covered in the C2 section which explores how the kit interacts with 16Shop's api to alter its behaviour.")]),t._v(" "),n("h4",{attrs:{id:"htaccess"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#htaccess"}},[t._v("#")]),t._v(" .htaccess")]),t._v(" "),n("p",[t._v("Within several directories a specially made Apache "),n("code",[t._v(".htaccess")]),t._v(" file (almost 10,000 lines!) redirects or blocks visitors based on attributes of the request. If the request appears to come from a known crawler, scanner or what would appear to not be a potential victim, it will redirect the browser to a legitimate URL.")]),t._v(" "),n("h4",{attrs:{id:"crawlerdetect"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#crawlerdetect"}},[t._v("#")]),t._v(" CrawlerDetect")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/JayBizzle/Crawler-Detect",target:"_blank",rel:"noopener noreferrer"}},[t._v("CrawlerDetect"),n("OutboundLink")],1),t._v(" is an open source tool written in PHP which aims to identify and stop known bots/crawlers/spiders based on the "),n("code",[t._v("user_agent")]),t._v(" and "),n("code",[t._v("http_from")]),t._v(" headers.")]),t._v(" "),n("h4",{attrs:{id:"antibot"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#antibot"}},[t._v("#")]),t._v(" Antibot")]),t._v(" "),n("p",[t._v("Antibot is a popular service for many PaaS kits that deserves a deep-dive all of it's own. The service provides an api which can be queried along with an ip. If the ip has been associated with a bot or service which crawls for malicious sites it will block the request and present the requester with a 403 http response.")]),t._v(" "),n("p",[t._v("As you can see from the below code taken from "),n("code",[t._v("antibot.php")]),t._v(" it will check for the existence of an "),n("code",[t._v("antibot.ini")]),t._v(" file which should (if the user has paid for the service) contain an API key. If it exists, it allows the function "),n("code",[t._v("getUserIPszz()")]),t._v(" to be called which checks the IP against antibot and logs the details if it is blocked.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519161-d780fb00-a280-11eb-80ca-b92fb5e6ad69.png",alt:"antibotcode-1"}})]),t._v(" "),n("h4",{attrs:{id:"killbot"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#killbot"}},[t._v("#")]),t._v(" Killbot")]),t._v(" "),n("p",[t._v("Killbot is a recent addition to some versions of 16Shop and is running as a direct competitor to antibot, touting additional functionality and cheaper costs. Killbot code is not present in this kit we are looking at, however I will be producing a write-up on this soon.")]),t._v(" "),n("h4",{attrs:{id:"proxyblock"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#proxyblock"}},[t._v("#")]),t._v(" Proxyblock")]),t._v(" "),n("p",[t._v("16Shop also utilises some PHP code alongside a third-party api hosted by "),n("code",[t._v("mind-media.com")]),t._v(" which will check the visitor's IP against a list of known proxy and VPN IP ranges. If there's a match, the visitor is presented with a 403 http response and details are logged.")]),t._v(" "),n("h4",{attrs:{id:"arguments"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#arguments"}},[t._v("#")]),t._v(" Arguments")]),t._v(" "),n("p",[t._v("16Shop can utilise required arguments/parameters as part of a GET request when navigating to the domain. This means that unless you know the param which is specified by the kit owner you will be unable to even reach the phishing page."),n("br"),t._v("\nThis is covered in more detail further on.")]),t._v(" "),n("h3",{attrs:{id:"drm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#drm"}},[t._v("#")]),t._v(" DRM")]),t._v(" "),n("p",[t._v("Similarly to other big players on the PaaS market, 16Shop includes basic digital rights management and licensing capabilities to try and prevent individuals from running off with the source code and deploying the kit as many times as they like. Likewise this allows further control from the 16Shop author and monetisation options."),n("br"),t._v("\nThis control mainly consists of various functions and obfuscated PHP code, stemming from "),n("code",[t._v("index.php")]),t._v(" in the root of the kit directory.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519346-07300300-a281-11eb-8ccc-cc2f37e47564.png",alt:"image-4"}})]),t._v(" "),n("p",[t._v("Looking at "),n("code",[t._v("index.php")]),t._v(" it's clear there is not much there, however it is including "),n("code",[t._v("load.php")]),t._v(" and calling a function."),n("br"),t._v("\nOpening "),n("code",[t._v("load.php")]),t._v(" we can see it contains obfuscated code to try and prevent further analysis.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519467-2333a480-a281-11eb-8684-3dcc840d4ae0.png",alt:"drmcode"}}),n("br"),t._v(" "),n("em",[t._v("Some code truncated for brevity")])]),t._v(" "),n("p",[t._v("Taking the variables and unescaping/converting from HEX and Octal reveals the variables and functions being declared:")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519534-33e41a80-a281-11eb-9fc1-f513f07dc287.png",alt:"obfus1"}})]),t._v(" "),n("p",[t._v("From here we can easily deobfuscate the eval taking place from"),n("br"),t._v(" "),n("code",[t._v('$kMjE4NDcxODYxs($det($wNTg0NDQ1MjE4z($gMjY1MzcwMjYf($aNzk0MjAxOTMyd("7U0Jrts...yN9gO3/6o/w8="))))))')]),n("br"),t._v("\nto"),n("br"),t._v(" "),n("code",[t._v('hex2bin(str_rot13(gzinflate(str_rot13(base64_decode("7U0Jrts...yN9gO3/6o/w8="))))));')])]),t._v(" "),n("p",[t._v("Calling these functions in reverse reveals further obfuscated code. (Bonus points for spotting the easter egg within the variable names)")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519663-4fe7bc00-a281-11eb-8ec8-65a351840b6d.png",alt:"obfus2"}})]),t._v(" "),n("p",[t._v("After a few more rounds of deobfuscation we end up with the following code:")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519695-57a76080-a281-11eb-8a58-b0fc484595e5.png",alt:"unobfus1-1"}})]),t._v(" "),n("p",[t._v("This code is mainly responsible for checking the deployment has been registered- and if it has, will return and process the code required to allow the kit to function correctly. This alongside some other PHP embedded in the kit serves as a method of ensuring any deployments have to go via 16Shops C2 to be validated and work as intended.")]),t._v(" "),n("h3",{attrs:{id:"c2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#c2"}},[t._v("#")]),t._v(" C2")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://media.giphy.com/media/8EmeieJAGjvUI/giphy.gif",alt:""}})]),t._v(" "),n("p",[t._v("As we can now see the api endpoint and data being sent to 16Shops C2, we can simply call it directly and capture the response to see what is happening behind the scenes when browsing to the root URL of a 16Shop deployment.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519760-68f06d00-a281-11eb-81c9-4a518270e19c.png",alt:"c2codereturned"}})]),t._v(" "),n("p",[t._v("There is a lot happening within this chunk of code so let's break it down;")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519799-71e13e80-a281-11eb-893a-07240f92c0b9.png",alt:"image-3"}})]),t._v(" "),n("p",[n("code",[t._v("main.php")]),t._v(' is being included, which contains various functions for the kit such as getting the IP and OS information of the visitor, sending emails to the threat actor behind the deployment and most interestingly obtaining the "settings" for the deployment.')]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115519839-7b6aa680-a281-11eb-9cc4-7b13459dbfd7.png",alt:"getsetting"}})]),t._v(" "),n("p",[t._v("This function will return a json response which contains the configuration options for the deployment as configured by the actor. For example;")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("                                           \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email_result"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email@domain.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"login_result"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email@domain.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"lock_platform"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                      \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sender_mail"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin@16shop.us"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"site_parameter"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("               \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"site_password"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"16shop"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"site_param_on"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                    \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"site_pass_on"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                       \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"send_login"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                       \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"get_photo"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                        \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"get_vbv"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                          \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"get_email"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                        \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"get_bank"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                         \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"onetime"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                          \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"block_host"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                       \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"block_ua"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                         \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"block_iprange"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                    \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"block_isp"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                        \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"block_vpn"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                        \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"letter"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unusual_activity"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("             \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"double_cc"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                          \n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"block_referrer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"on"')]),t._v("                      \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("The "),n("code",[t._v("email_result")]),t._v(" and "),n("code",[t._v("login_result")]),t._v(" values contain the exfil email addresses associated with this deployment, and all phishing results will be sent to these mailboxes. Tracking these addresses allow us to attribute multiple deployments to the same actor(s) until their email address is either rotated or closed by the mail provider. This has been such an effective method of tracking activity in fact, that some even felt compelled to leave me a message by amending their "),n("code",[t._v("email_result")]),t._v(" details.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115520001-9e955600-a281-11eb-8ef6-b2583433d7a7.png",alt:"image-5"}})]),t._v(" "),n("p",[t._v('Some of these "settings" dicate how some of the rest of this code will execute.')]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115520057-a94feb00-a281-11eb-876a-08815ed0353e.png",alt:"image-2"}})]),t._v(" "),n("p",[t._v('As we can see, most of these settings are set to "on" which will result in the referenced PHP files to be executed. These PHP scripts are designed to try and prevent bots, crawlers and other IP ranges to try and reduce detections from automated systems.')]),t._v(" "),n("p",[t._v("The following code block is responsible for then directing the potential victim to the phishing page. This functionality is not unique to 16Shop, but serves as another clever mechanism to avoid deliberate/accidental detection.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115520080-b10f8f80-a281-11eb-9460-7a681c496394.png",alt:"image-1"}})]),t._v(" "),n("p",[t._v("From the above code we can see the following steps are taking place")]),t._v(" "),n("ul",[n("li",[t._v("If the setting "),n("code",[t._v("site_param_on")]),t._v(" is on, get the specified "),n("code",[t._v("site_parameter")]),t._v(" stored in "),n("code",[t._v("$setting")])]),t._v(" "),n("li",[t._v("Check the specified parameter has been supplied as an argument within the GET request (i.e. "),n("code",[t._v("https://exampledomain.com/?param")]),t._v(" with param matching the setting).")]),t._v(" "),n("li",[t._v("If it's present set "),n("code",[t._v("$key")]),t._v(" to the PHP session key")]),t._v(" "),n("li",[t._v("If it's not present, log and respond with 403")]),t._v(" "),n("li",[t._v("If "),n("code",[t._v("$key")]),t._v(" has been set, log the request and set the location to "),n("code",[t._v("https://exampledomain.com/myca?key=$key")])])]),t._v(" "),n("p",[t._v("At this point in the phish, if the visitor has been identified as:")]),t._v(" "),n("ul",[n("li",[t._v("Not a bot")]),t._v(" "),n("li",[t._v("Not coming from a blacklisted IP")]),t._v(" "),n("li",[t._v("Not using a proxy/VPN service")]),t._v(" "),n("li",[t._v('Provided the correct "key"/parameter (generally from clicking on the URL from within a phishing email)\nThey will be forwarded on to the phishing page.')])]),t._v(" "),n("h3",{attrs:{id:"attack-phase"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#attack-phase"}},[t._v("#")]),t._v(" Attack phase")]),t._v(" "),n("p",[t._v("When a potential victim lands on the first stage phishing page, "),n("code",[t._v("session.php")]),t._v(" is called which checks for the existence of a valid "),n("code",[t._v("$key")]),t._v(" which was declared before being redirected."),n("br"),t._v("\nThis is to prevent guessing or visiting the phishing page directly without first providing the valid parameter.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115520281-e74d0f00-a281-11eb-922d-30635d843a7b.png",alt:"keycode"}})]),t._v(" "),n("p",[t._v('After "de-fanging" the kit and changing the output of some functions, we are able to easily run this locally to simulate the process that the victim would follow. Any malicious external calls have been removed and all results are output to local files instead of emails.')]),t._v(" "),n("p",[t._v("The process of this phish breaks down to the following stages:")]),t._v(" "),n("ol",[n("li",[t._v("Victim prompted for user ID and password for their AMEX account")]),t._v(" "),n("li",[t._v("Victim prompted for full name and billing address")]),t._v(" "),n("li",[t._v("Victim prompted for credit card information")]),t._v(" "),n("li",[t._v("Victim prompted for email address and email password")]),t._v(" "),n("li",[t._v("Victim redirected to legitimate "),n("code",[t._v("americanexpress.com")]),t._v(" landing page")])]),t._v(" "),n("h4",{attrs:{id:"amex-login"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#amex-login"}},[t._v("#")]),t._v(" AMEX login")]),t._v(" "),n("p",[t._v("The potential victim is prompted with an almost exact copy of AMEX's own account login screen, with even various assets such as images being pulled from "),n("code",[t._v("americanexpress.com")]),t._v(" directly.")]),t._v(" "),n("p",[t._v("Upon entering a user id and password a POST is sent to "),n("code",[t._v("login.php")]),t._v(" which takes that POST data and constructs message which is then sent to the kit owner or email address declared within "),n("code",[t._v("$setting")]),t._v("."),n("br"),t._v("\nThe message contents would appear as below in the threat actors mailbox:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('#--------------------[ AMEX LOGIN ]-------------------------#\nUser ID\t\t    : ".$_POST[\'UserID\']."\nPassword\t\t: ".$_POST[\'password\']."\nAccount Type\t: ".$_POST[\'type\']."\n#--------------------------[ PC INFORMATION ]-------------------------#\nIP Address\t\t: ".$ip."\nISP\t\t        : ".$ispuser."\nRegion\t\t    : ".$regioncity."\nCity\t\t    : ".$citykota."\nContinent\t\t: ".$continent."\nTimezone\t\t: ".$timezone."\nOS/Browser\t\t: ".$os." / ".$br."\nDate\t\t\t: ".$date."\nUser Agent\t\t: ".$user_agent."\n#--------------------------[ PRIVATE ]-----------------------------#\n')])])]),n("p",[t._v("After sending this information, the IP of the victim is logged within 2 files, "),n("code",[t._v("total_login.txt")]),t._v(" and "),n("code",[t._v("log_visitor.txt")]),t._v(". These are referenced further on when we take a look at the admin panel of 16Shop."),n("br"),t._v("\nThe next location the victim is directed to is "),n("code",[t._v("verification?request_type=LogonHandler&Face=en_US&key=$key")])]),t._v(" "),n("h4",{attrs:{id:"billing-information"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#billing-information"}},[t._v("#")]),t._v(" Billing information")]),t._v(" "),n("p",[t._v("This page requests the potential victims billing address information including full name and date of birth.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523124-a6a2c500-a284-11eb-8d04-37339530a0ba.png",alt:"billingaddress"}})]),t._v(" "),n("p",[t._v("Once the fields have been populated and the victim clicks continue, there is another POST sent to "),n("code",[t._v("verification_payment.php")]),t._v(" where the form data is temporarily stored within a hidden input field.")]),t._v(" "),n("h4",{attrs:{id:"cc-info"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cc-info"}},[t._v("#")]),t._v(" CC info")]),t._v(" "),n("p",[t._v("On this next page, the victim is prompted for their credit card information.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523252-c9cd7480-a284-11eb-9539-10ca885accf6.png",alt:"ccinfo"}})]),t._v(" "),n("p",[t._v("There are several functions called here which check the validity of the data entered, and will only allow the user to progress if they enter a valid AMEX credit card number.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523284-d3ef7300-a284-11eb-9885-cb05bc9d0134.png",alt:"cccheckfunc"}})]),t._v(" "),n("p",[t._v("If the card information entered pass these checks, the card data along with the billing information stored within the hidden form are submitted via POST to "),n("code",[t._v("submit_verification.php")]),t._v(" which again constructs a message which is then emailed to the threat actor.The message content would appear as below.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('$messag#--------------------[ 16SHOP - AMEX ]-------------------------#\nUser ID\t\t    : ".$_SESSION[\'UserID\']."\nPassword\t\t: ".$_SESSION[\'password\']."\n#--------------------------------[ CARD DETAILS ]----------------------------#\nType\t\t\t: ".strtoupper($bin["scheme"])." - ".strtoupper($bin["type"])."\nLevel\t\t\t: ".strtoupper($bin["brand"])."\nCardholders     : ".$_POST[\'fullname\']."\nCC Number\t\t: ".$_POST[\'cc1\']."\nExpired\t\t    : ".$_POST[\'exp_month\']."/".$_POST[\'exp_year\']."\nCard Security Code\t: ".$_POST[\'cvv\']."\n4-Digits Card   : ".$_POST[\'cvv2\']."\nCopy Check Live : ".$_POST[\'cc1\']."|".$_POST[\'exp_month\']."|".$_POST[\'exp_year\']."\n#-------------------------[ BILLING ADDRESS ]--------------------------------#\nFull Name\t\t: ".$_POST[\'fullname\']."\nAddress\t\t    : ".$_POST[\'address\']."\nCity\t\t\t: ".$_POST[\'city\']."\nState\t\t\t: ".$_POST[\'state\']."\nCountry\t\t    : ".$_POST[\'country\']."\nZip\t\t\t    : ".$_POST[\'zipcode\']."\nDOB\t\t\t    : ".$_POST[\'tanggal\']."/".$_POST[\'bulan\']."/".$_POST[\'tahun\']."\nSSN\t\t\t    : ".$_POST[\'ssn\']."\n#--------------------------[ PC INFORMATION ]-------------------------#\nIP Address\t\t: ".$ip."\nISP\t\t        : ".$ispuser."\nRegion\t\t    : ".$regioncity."\nCity\t\t    : ".$citykota."\nContinent\t\t: ".$continent."\nTimezone\t\t: ".$timezone."\nOS/Browser\t\t: ".$os." / ".$br."\nDate\t\t\t: ".$date."\nUser Agent\t\t: ".$user_agent."\n#--------------------------[ PRIVATE ]-----------------------------#\n')])])]),n("p",[t._v("If the data is not valid or the user did not complete the form, they are redirected to the billing information page and prompted to restart the process.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523360-e5d11600-a284-11eb-878b-81d04f4c16fd.png",alt:"ccredirect"}})]),t._v(" "),n("p",[t._v("The victim IP is once again logged to the following log files: "),n("code",[t._v("total_cc.txt")]),t._v(", "),n("code",[t._v("total_bin.txt")]),t._v(", "),n("code",[t._v("log_visitor.txt")]),t._v(". After this logging takes place, the victim is then redirected to "),n("code",[t._v("link_email.php")]),t._v(".")]),t._v(" "),n("h4",{attrs:{id:"email-credentials"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#email-credentials"}},[t._v("#")]),t._v(" Email credentials")]),t._v(" "),n("p",[t._v('The next screen prompts the victim to "linked an email account", and generically asks for their email credentials.')]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523426-f6818c00-a284-11eb-9f89-ccc7f3dac60b.png",alt:"linkemail"}})]),t._v(" "),n("p",[t._v("Once the information is entered, this data is submitted via POST to "),n("code",[t._v("submit_email.php")]),t._v(" which again, constructs an email to the threat actor and logs the victim IP to "),n("code",[t._v("total_email.php")]),t._v(" and "),n("code",[t._v("log_visitor.php")]),t._v("."),n("br"),t._v("\nThe mail body would appear as below:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('#--------------------[ AMEX LOGIN ]-------------------------#\nUser ID\t\t: ".$_POST[\'emailaddress\']."\nPassword\t\t: ".$_POST[\'emailpassword\']."\n#--------------------------[ PC INFORMATION ]-------------------------#\nIP Address\t\t: ".$ip."\nISP\t\t    : ".$ispuser."\nRegion\t\t    : ".$regioncity."\nCity\t\t    : ".$citykota."\nContinent\t\t: ".$continent."\nTimezone\t\t: ".$timezone."\nOS/Browser\t\t: ".$os." / ".$br."\nDate\t\t\t: ".$date."\nUser Agent\t\t: ".$user_agent."\n#--------------------------[ PRIVATE ]-----------------------------#\n')])])]),n("p",[t._v("After the logging is complete, the victim is redirected to "),n("code",[t._v("done.php")]),t._v(".")]),t._v(" "),n("h4",{attrs:{id:"completion"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#completion"}},[t._v("#")]),t._v(" Completion")]),t._v(" "),n("p",[t._v("This is the final page in the attack phase of this phish. The victim is thanked for their information and then redirected to the legitimate AMEX account login page.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523820-609a3100-a285-11eb-82f6-ebd641c8f7e2.png",alt:"thanks"}})]),t._v(" "),n("p",[t._v('Another interesting tactic employed by the 16Shop kit here is through the use of a function called "onetime". Once the victim has reached the final step, and if the "onetime" '),n("code",[t._v("$setting")]),t._v(' is set to "on", their IP is logged to the file '),n("code",[t._v("onetime.dat")]),t._v(".")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523924-7c053c00-a285-11eb-9475-ad9a09b90990.png",alt:"onetime"}})]),t._v(" "),n("p",[t._v("You may recall we saw this setting referenced in the code being returned from the C2 earlier on, along with the file "),n("code",[t._v("onetime.php")]),t._v(". This PHP code is responsible for ensuring that once a victim has entered their information and completed the process, they are unable to visit the page again and instead are immediatley redirected to the legitimate AMEX account login url.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115523941-81fb1d00-a285-11eb-95f7-1dec5fc1326b.png",alt:"onetimecheck"}})]),t._v(" "),n("p",[t._v("There are many functions at play here. At a high level, the contents of "),n("code",[t._v("onetime.dat")]),t._v(" are retrieved along with some other blacklists utilised by the kit. The victim or visitor IP is then checked against this array of IP addresses and if there is a match, the visit is logged and the user redirected to "),n("code",[t._v("https://online.americanexpress.com/myca/logon/us/action/LogonHandler?request_type=LogonHandler&Face=en_US")]),t._v(".")]),t._v(" "),n("p",[t._v("And with that, the victim interaction is done and any sensitive information will be with the threat actor behind the deployment.")]),t._v(" "),n("h3",{attrs:{id:"admin-panel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#admin-panel"}},[t._v("#")]),t._v(" Admin panel")]),t._v(" "),n("h4",{attrs:{id:"dashboard"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dashboard"}},[t._v("#")]),t._v(" Dashboard")]),t._v(" "),n("p",[t._v("16Shop kits also come with an admin panel of sorts, which allows for the threat actor to access an overview/dashboard of recent events and how successful the deployment has been."),n("br"),t._v("\nNavigating to "),n("code",[t._v("/admin/login.php")]),t._v(" presents the following login page.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115524345-ef0eb280-a285-11eb-976b-1235381b08e7.png",alt:"adminlogin"}})]),t._v(" "),n("p",[t._v("Looking at the PHP code, upon entering the key, username and password the following function is called.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115524357-f59d2a00-a285-11eb-9409-782a31647782.png",alt:"adminloginfunc"}})]),t._v(" "),n("p",[t._v("This takes the provided key, username and password and submits them to an API endpoint controlled by the 16Shop author. These details are then checked and if valid, the "),n("code",[t._v("$server_output")]),t._v(' will contain "valid".'),n("br"),t._v("\nHumorously enough, an invalid request results in the following response.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115524407-0352af80-a286-11eb-8b72-565c27d34d54.png",alt:"invalidcall"}})]),t._v(" "),n("p",[t._v("When validated, the operator will be presented with a dashboard containing statistics and basic details on visits and successful phishing attempts.")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115524438-09e12700-a286-11eb-92d2-911f22452327.png",alt:"paneldashboard"}})]),t._v(" "),n("p",[t._v("Each menu item on the left hand side of the page offers different views allowing for:")]),t._v(" "),n("ul",[n("li",[t._v("Adding or amending the antibot API key.")]),t._v(" "),n("li",[t._v("Listing IP and OS information on visitors and victims")]),t._v(" "),n("li",[t._v("Information on blocked visitors and bots")]),t._v(" "),n("li",[t._v("Resetting the various log files which victim/bot IP information is logged to.\nOutside of these capabilities the dashboard simply serves as a portal for the operator to gather basic statistics and information about the deployment. All victim information is sent directly to the threat actor via email and is not stored locally on web host.")])]),t._v(" "),n("h4",{attrs:{id:"statistic-sources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#statistic-sources"}},[t._v("#")]),t._v(" Statistic sources")]),t._v(" "),n("p",[t._v("The stats presented on the admin dashboard are pulled directly from various log files written to during the attack phase.")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("log_visitor.txt")]),t._v(" Contains IP and OS info of the victim, as well as a timestamp for each stage of the phish they reached")]),t._v(" "),n("li",[n("code",[t._v("total_bin.txt")]),t._v(" BIN number and OS of victims which entered bank details")]),t._v(" "),n("li",[n("code",[t._v("total_cc.txt")]),t._v(" IP of each victim which entered CC info")]),t._v(" "),n("li",[n("code",[t._v("total_email.txt")]),t._v(" IP of each victim which entered email credentials")]),t._v(" "),n("li",[n("code",[t._v("total_login.txt")]),t._v(" IP of each victim which submitted credentials\nThese files do not contain credentials or data which may lead the reader to attribute the information to a victims identity, however all of these log files are exposed for each 16Shop deployment. This means anyone can view the contents of these log files.")])]),t._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115524528-241b0500-a286-11eb-89af-2d142d9766f9.png",alt:"logexample"}})]),t._v(" "),n("p",[t._v("Some time ago I ran a small experiment scraping these exposed log files and performing some analysis on a sample of the data from over a week period. If you're interested in what was discovered take a look at the post "),n("RouterLink",{attrs:{to:"/_posts/2020-05-12-16Shop-victim-analysis.html"}},[t._v("here")]),t._v(".")],1),t._v(" "),n("h2",{attrs:{id:"ioc-s"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ioc-s"}},[t._v("#")]),t._v(" IoC's")]),t._v(" "),n("h3",{attrs:{id:"hashes"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hashes"}},[t._v("#")]),t._v(" Hashes")]),t._v(" "),n("p",[t._v("Below are some common hashes for 16Shop kit zip files in their various forms and versions. This also includes commonly found cracked kits which have not been re-branded. (SHA-256)")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("D59D89BDDB51425E1ADCF064A67697D491C296DAA8AED35F99A6F63075559D44\nECBC631A09CD2C4B2C6DBE393301AFC6D2AC545FAF9E599F6DCA296FDD4F1112\n3C7E53177AEC628F12485F0C29A05B6312581448A172A759CFC7FE46296DC0C7\n1554C68833C7D233FFD947D00865C5E102FEBB1321931D6ACD6F6404DF568F0C\nE0F10F410EDCD2B2FB37FFDF6541DCC302899A9C584759E43F85A34308781043\n1D2FF1E46E15F8F75458077C56183B16834A42AF40B03E649601D3BAB7178004\n16DD5BF59391B1BF81F3861062654690B751208B2DFB8D37815F12B91BCD34E3\nCB6E71C71845F41A7FBFB69D63A56E6024493492E23F392B056A84772D0DCF94\nA41784D93D1AC04ED554AF814A56A5F99A53368D87F89B01D92C0B82C9291C87\n3FDE92528C99D96151C5EE53E828A89555936825E5F38E3F4F47EA2D381E660F\n3C626FC4D0169B223ED95D190A73382C5D52A854D5EC8CBBFCD4AC7E65216136\n0D1D53B3B28A2CC82E03D3F823E881B7DAF55AADFF7FA784183D30634EBD91F2\n9664C129777B69C88E9A63439F8836B38AD25A8EEE7B3D16D557C898F0B77B89\nB3335A4A30360533BF982198DAD98711D90EC43C3C396754149C77B06536822D\n2C0100E6147D43DCA5437AEBD2B2C044A5064F28CFE0A2E1E4137FC7B8F12B44\n969A59F3F973E29D7FC8672AF5F3FC57D7B21855866A60A486C18B8D40EC9648\n4BD048EBF4B4F7DD71E8D0B532FDE35967423A77589EA43C11262B751A138197\nA74CFEB948863D04D3BD915082D1EA13DF32CAF25738088CFC3D4B00E044E65F\nA3C3F907ED1F93FBFC7F9CF89F7EB22B9B4D24BD6EFBC5FEF64627E03A5D6CED\nCE143EC97EE4314A24DB9DD666E25FBE52E4F97A4E0D351F6BCD21868493FD2B\n04DB6A464A38C110039406E5DBE80CC09526D0EB34D36DF335EEB543DB5A9248\nA331E200BD78329979FB02CA5B613DA6183CC8DCD87E24F79FAF2D2BBBC182D9\n119D463D63016E3AD6A11484C1CF3C67602EA692623986F36EAA5043054B42E9\n888985300972915442E09981094800CF5DF4A3992D42AEEEBF74D20C01F12D8A\n60D65062E50FE51BC693ED6B3F762D760F1F4EA47D948E8DC7D95806636796C5\n177E2D6BC0E39EF7FE8631FC0B35A3E40886C280BA119C90D13455C145BC5EDE\n9F2074E0E645DCB90C2F88A5454222C474D2B190F3787413F099358BEF39A393\n15C8BA0E16635974D3FDD39B8D01A7679E67E92EB4368DB3BC80DFFF2571DE0D\n786411310F28F35FC7162D94458B956B27781ABC09CB742C2E8947E88B3E0DCC\nA7C40CAC5D70C2CE37DCAB1BEFE8DA5A8B50BFCA0744532D3395F68C638706E4\nF3FD85565F6305B90AAD9DB383234C19E271A9066B97CD941D37A42EB3AD7F9C\nC654FFCBE96C3F08AC750073B5DB5FB3465F41BFF5CF2F88570C0BD88324EE02\nAA0B0F3B90DEF9F832B35F5C4D5E55C22CA28AF7F272422A27A8A3EE24C2284A\n1666295080DAFC6270EBBE71659FC0522C41714D4F89C62485579541CC6D460A\n5FD138A3476CF3297CE4931A783ADDB90E9AC2096C9E2E93DE7F12908AA47377\n8F2AB02C04F53F84FF8F7D2003439787367F9D710EF7306060B21114FEF8F349\nB3684388AC2F55EE2EF0254A8518ECB695480CE02B954781D898424B5F074561\nAF061C782C28E4F0BCF064C083216D22A715306B0C72F512E215D7BFC849BA92\n1A286E02D29FFAAF404B7C35CDAA8450264F753FFBD779BE78D78AE1AEF581DD\n49F4EC03DB7CBD77DCFAEDD1750F168ECCB8441842712EE8988D0ABEE29C2673\n30F514B48471409D438BF5844E943B54A0D39ABC79C6764652AB27FAB3A8CC51\nF7306A94AE651D9FEE774396E61EE231B66F686C0FB6482E8F6DD6FCAD47E097\n")])])]),n("h3",{attrs:{id:"ip-addresses"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ip-addresses"}},[t._v("#")]),t._v(" IP addresses")]),t._v(" "),n("p",[t._v("These ip's have been commonly associated with 16Shop deployments or C2 calls and should be treated with suspicion. Many of them are associated with dynamic DNS providers.")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("178.128.104.179\n128.199.154.155\n162.241.120.50\n162.241.121.114\n162.241.70.167\n162.241.114.38\n40.121.142.222\n162.241.115.237\n162.241.121.96\n63.250.41.93\n52.249.252.153\n162.144.100.8\n35.223.249.15\n64.225.124.116\n")])])]),n("h3",{attrs:{id:"yara-rules"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#yara-rules"}},[t._v("#")]),t._v(" Yara rules")]),t._v(" "),n("p",[t._v("These rules can be ran against zip files or any repository of phishing kit zips to identify if they contain common artefacts of 16Shop kits. The generic rule aims to capture any 16Shop kit including cracked versions, whereas the specific rules will identify 16Shop kits based on their targeted brand.")]),t._v(" "),n("details",[n("summary",[t._v("Generic")]),t._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('rule PhishKit_16Shop\n{\n    meta:\n        description = "Generic rule for 16Shop kits included cracked versions."\n        author = "@sysgoblin"\n        date = "2020-07-18"\n        reference = ""\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "security"\n        $dir2 = "admin"\n        $server_ini = "server.ini"\n        $setting_ini = "setting.ini"\n        $file1 = "onetime.php"\n        $file2 = "main.php"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        ($server_ini or $setting_ini) and\n        $file1 and $file2 and\n        $dir1 and $dir2\n}\n')])])])]),t._v(" "),n("br"),t._v(" "),n("details",[n("summary",[t._v("Apple")]),t._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('rule PhishKit_16Shop_Apple\n{\n    meta:\n        description = "Rule for 16Shop kits targeting Apple, including cracked versions."\n        author = "@sysgoblin"\n        date = "2020-07-18"\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "security"\n        $dir2 = "admin"\n        $dir3 = "result"\n        $server_ini = "server.ini"\n        $setting_ini = "setting.ini"\n        $file1 = "onetime.php"\n        $file2 = "main.php"\n        $ap_file1 = "truelogin.php"\n        $ap_file2 = "icloud.css"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        ($server_ini or $setting_ini) and\n        all of ($file*) and\n        all of ($dir*) and\n        all of ($ap_file*)\n}\n')])])])]),t._v(" "),n("br"),t._v(" "),n("details",[n("summary",[t._v("Amazon")]),t._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('rule PhishKit_16Shop_Amazon\n{\n    meta:\n        description = "Rule for 16Shop kits targeting Amazon, including cracked versions."\n        author = "@sysgoblin"\n        date = "2020-07-18"\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "security"\n        $dir2 = "admin"\n        $dir3 = "result"\n        $server_ini = "server.ini"\n        $setting_ini = "setting.ini"\n        $file1 = "onetime.php"\n        $file2 = "main.php"\n        $am_dir = "ap"\n        $am_file1 = "additional.php"\n        $am_file2 = "upload-cc.php"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        ($server_ini or $setting_ini) and\n        all of ($file*) and\n        all of ($dir*) and\n        $am_dir and\n        all of ($am_file*)\n}\n')])])])]),t._v(" "),n("br"),t._v(" "),n("details",[n("summary",[t._v("PayPal")]),t._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('rule PhishKit_16Shop_PayPal\n{\n    meta:\n        description = "Rule for 16Shop kits targeting PayPal, including cracked versions."\n        author = "@sysgoblin"\n        date = "2020-07-18"\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "security"\n        $dir2 = "admin"\n        $dir3 = "result"\n        $server_ini = "server.ini"\n        $setting_ini = "setting.ini"\n        $file1 = "onetime.php"\n        $file2 = "main.php"\n        $pp_dir = "pap"\n        $pp_file1 = "limited.ini"\n        $pp_file2 = "unusual_activity.ini"\n        $pp_file3 = "unusual.php"\n        $pp_file4 = "upload_selfie.php"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        ($server_ini or $setting_ini) and\n        all of ($file*) and\n        all of ($dir*) and\n        $pp_dir and\n        2 of ($pp_file*)\n}\n')])])])]),t._v(" "),n("br"),t._v(" "),n("details",[n("summary",[t._v("AMEX")]),t._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('rule PhishKit_16Shop_Amex\n{\n    meta:\n        description = "Rule for 16Shop kits targeting AMEX, including cracked versions."\n        author = "@sysgoblin"\n        date = "2020-07-18"\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "security"\n        $dir2 = "admin"\n        $dir3 = "result"\n        $server_ini = "server.ini"\n        $setting_ini = "setting.ini"\n        $file1 = "onetime.php"\n        $file2 = "main.php"\n        $amex_dir = "myca"\n        $amex_file1 = "submit_verification.php"\n        $amex_file2 = "amex_generic_img.gif"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        ($server_ini or $setting_ini) and\n        all of ($file*) and\n        all of ($dir*) and\n        $amex_dir and\n        all of ($amex_file*)\n}\n')])])])]),t._v(" "),n("br"),t._v(" "),n("h3",{attrs:{id:"feeds"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#feeds"}},[t._v("#")]),t._v(" Feeds")]),t._v(" "),n("p",[t._v("For a feed of recent 16Shop detections and exfil emails, check out the api over at "),n("a",{attrs:{href:"https://phishingreel.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("phishingreel.io"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"epilogue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#epilogue"}},[t._v("#")]),t._v(" Epilogue")]),t._v(" "),n("p",[t._v("Thanks for reading this c h o n k of a post. Here's a shout out to some awesome peeps who deserve a follow for helping review this content and also helping the fight against phishing!")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://twitter.com/dave_daves",target:"_blank",rel:"noopener noreferrer"}},[t._v("@dave_daves"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/JCyberSec_",target:"_blank",rel:"noopener noreferrer"}},[t._v("@JCyberSec_"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/nullcookies",target:"_blank",rel:"noopener noreferrer"}},[t._v("@nullcookies"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/aneilan",target:"_blank",rel:"noopener noreferrer"}},[t._v("@aneilan"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/steved3",target:"_blank",rel:"noopener noreferrer"}},[t._v("@steved3"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/n0p1ishing",target:"_blank",rel:"noopener noreferrer"}},[t._v("@n0p1ishing"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=s.exports}}]);