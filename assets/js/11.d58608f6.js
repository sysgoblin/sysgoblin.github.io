(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{377:function(e,t,n){"use strict";n.r(t);var a=n(27),i=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h2",{attrs:{id:"foreword"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#foreword"}},[e._v("#")]),e._v(" Foreword")]),e._v(" "),n("p",[e._v("This is a kit I have been tracking for some time now, and during that period have obtained dozens (if not hundreds) of copies, and detected thousands of deployments over the past few months.")]),e._v(" "),n("p",[e._v("This post will go in to detail on how the kit works from both the attacker and victim perspective and highlight some interesting findings. At the end I have also included some common IoC's for FreakzBrothers kits and Yara rules you can utilise when doing your own threat hunting.")]),e._v(" "),n("p",[e._v("You may notice some similarities if you read my recent post on "),n("RouterLink",{attrs:{to:"/_posts/2020-05-12-16Shop-victim-analysis.html"}},[e._v("16Shop")]),e._v(", as FreakzBrothers (despite being a different kit) shares some resources and techniques. As such, some chunks of this post are lifted straight from the other post.")],1),e._v(" "),n("h2",{attrs:{id:"background"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[e._v("#")]),e._v(" Background")]),e._v(" "),n("h3",{attrs:{id:"what-is-freakzbrothers"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#what-is-freakzbrothers"}},[e._v("#")]),e._v(" What is FreakzBrothers?")]),e._v(" "),n("p",[e._v('FreakzBrothers is a popular "Phishing-as-a-service" (PaaS) kit which targets several popular brands, designed  for malicious actors to quickly and easily set up believable phishing pages targeting popular brands.')]),e._v(" "),n("p",[e._v("As these kits are provided as a service, the individuals buying and using FreakzBrothers do not need to be skilled, thus widening the net for potential customers.")]),e._v(" "),n("p",[e._v("FreakzBrothers appears to be sold and distributed via social media or private channels, as it a popular tactic for a lot of phishing kits originating from SE Asia.")]),e._v(" "),n("h3",{attrs:{id:"cracked-versions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cracked-versions"}},[e._v("#")]),e._v(" Cracked versions")]),e._v(" "),n("p",[e._v('Unsurprisingly, in the criminal realm of phishing not everyone wants to pay for a service like FreakzBrothers and instead simply "crack" the kit and remove any functions which serve as to try and prevent unauthorised use.')]),e._v(" "),n("p",[e._v("FreakzBrothers does employ some basic methods in order to try and ensure users are authenticated and approved by the author. However, there are versions where these controls have been removed and is re-sold and distributed across multiple channels. Many cracked versions have also been completely re-branded to remove association with FreakzBrothers, but the underlying code and functionality are the same.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115612559-4db64980-a2e3-11eb-9b20-71779f1ae416.png",alt:"image-16"}})]),e._v(" "),n("h2",{attrs:{id:"analysis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#analysis"}},[e._v("#")]),e._v(" Analysis")]),e._v(" "),n("p",[e._v('We\'re going to be looking at a kit which is a few versions behind, however is still commonly seen being deployed. This particular kit targets Amazon, a popular "flavour" of FreakzBrothers. Other targets include Apple, PayPal, Netflix, and recently USAA.')]),e._v(" "),n("h3",{attrs:{id:"directory-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#directory-structure"}},[e._v("#")]),e._v(" Directory structure")]),e._v(" "),n("details",[n("summary",[e._v("tree output (long!)")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("AMAZON-FREAKZBROTHERS.V2.4.zip\n|   .htaccess\n|   additional.php\n|   antibot.ini\n|   blacklist.php\n|   blocker.php\n|   blocker2.php\n|   crawlerdetect.php\n|   index.php\n|   killbot.ini\n|   killbot.php\n|   lang.php\n|   main.php\n|   onetime.php\n|   proxyblock.php\n|   session.php\n|\n+---admin\n|   |   .htaccess\n|   |   antibot.php\n|   |   index.js\n|   |   index.php\n|   |   login.php\n|   |   logout.php\n|   |   reset.php\n|   |   setting.php\n|   |\n|   +---css\n|   |       bootstrap.min.css\n|   |       bootstrap.min.css.map\n|   |       paper-dashboard.css\n|   |       paper-dashboard.css.map\n|   |       paper-dashboard.min.css\n|   |\n|   +---demo\n|   |       demo.css\n|   |       demo.js\n|   |\n|   +---fonts\n|   |       nucleo-icons.eot\n|   |       nucleo-icons.ttf\n|   |       nucleo-icons.woff\n|   |       nucleo-icons.woff2\n|   |\n|   +---img\n|   |   |   apple-icon.png\n|   |   |   bg5.jpg\n|   |   |   damir-bosnjak.jpg\n|   |   |   default-avatar.png\n|   |   |   favicon.png\n|   |   |   header.jpg\n|   |   |   jan-sendereks.jpg\n|   |   |   logo-small.png\n|   |   |   mike.jpg\n|   |   |\n|   |   \\---faces\n|   |           ayo-ogunseinde-1.jpg\n|   |           ayo-ogunseinde-2.jpg\n|   |           clem-onojeghuo-1.jpg\n|   |           clem-onojeghuo-2.jpg\n|   |           clem-onojeghuo-3.jpg\n|   |           clem-onojeghuo-4.jpg\n|   |           erik-lucatero-1.jpg\n|   |           erik-lucatero-2.jpg\n|   |           joe-gardner-1.jpg\n|   |           joe-gardner-2.jpg\n|   |           kaci-baum-1.jpg\n|   |           kaci-baum-2.jpg\n|   |\n|   +---js\n|   |   |   paper-dashboard.js\n|   |   |   paper-dashboard.js.map\n|   |   |   paper-dashboard.min.js\n|   |   |\n|   |   +---core\n|   |   |       bootstrap.min.js\n|   |   |       jquery.min.js\n|   |   |       popper.min.js\n|   |   |\n|   |   \\---plugins\n|   |           bootstrap-notify.js\n|   |           chartjs.min.js\n|   |           perfect-scrollbar.jquery.min.js\n|   |\n|   +---scss\n|   |   |   paper-dashboard.scss\n|   |   |\n|   |   \\---paper-dashboard\n|   |       |   _alerts.scss\n|   |       |   _animated-buttons.scss\n|   |       |   _buttons.scss\n|   |       |   _cards.scss\n|   |       |   _checkboxes-radio.scss\n|   |       |   _dropdown.scss\n|   |       |   _fixed-plugin.scss\n|   |       |   _footers.scss\n|   |       |   _images.scss\n|   |       |   _inputs.scss\n|   |       |   _misc.scss\n|   |       |   _mixins.scss\n|   |       |   _navbar.scss\n|   |       |   _nucleo-outline.scss\n|   |       |   _page-header.scss\n|   |       |   _responsive.scss\n|   |       |   _sidebar-and-main-panel.scss\n|   |       |   _tables.scss\n|   |       |   _typography.scss\n|   |       |   _variables.scss\n|   |       |\n|   |       +---cards\n|   |       |       _card-chart.scss\n|   |       |       _card-map.scss\n|   |       |       _card-plain.scss\n|   |       |       _card-stats.scss\n|   |       |       _card-user.scss\n|   |       |\n|   |       +---mixins\n|   |       |       _buttons.scss\n|   |       |       _cards.scss\n|   |       |       _dropdown.scss\n|   |       |       _inputs.scss\n|   |       |       _page-header.scss\n|   |       |       _transparency.scss\n|   |       |       _vendor-prefixes.scss\n|   |       |\n|   |       \\---plugins\n|   |               _plugin-animate-bootstrap-notify.scss\n|   |               _plugin-perfect-scrollbar.scss\n|   |\n|   \\---vendor\n|           config.php\n|\n+---ap\n|   |   .DS_Store\n|   |   .htaccess\n|   |   authenticationContext.php\n|   |   bank.php\n|   |   bank_acc.php\n|   |   billing.php\n|   |   blacklist.php\n|   |   done.php\n|   |   email.php\n|   |   index.php\n|   |   login.php\n|   |   login_email.php\n|   |   payment.php\n|   |   signin.php\n|   |   submit_email.php\n|   |   submit_upload_cc.php\n|   |   updateBilling.php\n|   |   update_billing.php\n|   |   verify_credit.php\n|   |\n|   +---files\n|   |   |   bank.php\n|   |   |   billing.php\n|   |   |   card.php\n|   |   |   done.php\n|   |   |   email.php\n|   |   |   index.php\n|   |   |   locked.php\n|   |   |   login-aol.php\n|   |   |   login-gmail.php\n|   |   |   login-hotmail.php\n|   |   |   login-hotmailjp.php\n|   |   |   login-yahoo.php\n|   |   |   login-yahoojp-mobile.php\n|   |   |   login-yahoojp.php\n|   |   |   signin.php\n|   |   |   signin_mobile.php\n|   |   |   upload-cc.php\n|   |   |\n|   |   \\---comcast\n|   |       |   index.php\n|   |       |\n|   |       \\---Assets\n|   |           +---css\n|   |           |       fonts-remote.min.css\n|   |           |       styles-light.min.css\n|   |           |\n|   |           +---img\n|   |           |       favicon.ico\n|   |           |\n|   |           \\---js\n|   |                   com.js\n|   |                   coms2.js\n|   |\n|   \\---google\n|           2googlelogo_color_112x36dp.png\n|           arrow_back_grey600_24dp.png\n|           avatar_2x.png\n|           checkmark.png\n|           cJZKeOuBrn4kERxqtaUH3T8E0i7KZn-EPnyo3HZu7kw.woff\n|           DXI1ORHCpsQm3Vp6mXoaTXhCUOGz7vYGh680lGh-uXM.woff\n|           googleg_lodp.ico\n|           googlelogo_color_112x36dp.png\n|           index.php\n|           logo_1x.png\n|           logo_2x.png\n|           universal_language_settings-21.png\n|           wlogostrip_230x17_1x.png\n|           wlogostrip_230x17_2x.png\n|           x_8px.png\n|\n+---assets\n|   |   .DS_Store\n|   |   index.php\n|   |\n|   +---css\n|   |       billing.css\n|   |       hotmail.css\n|   |       main.css\n|   |       mobile_login.css\n|   |       yahoo-grid.css\n|   |       yahoo-main.css\n|   |       yahoojp-mob.css\n|   |       yahoojp-mobile.css\n|   |       yahoojp.css\n|   |\n|   +---img\n|   |       .DS_Store\n|   |       0.jpg\n|   |       amazon.png\n|   |       AmazonUIBaseCSS-sprite_1x-c4a765aedd886dc04d89e7e93b6a02c59ecb7013._V2_.png\n|   |       favicon.ico\n|   |       logo.png\n|   |       logo_pc.png\n|   |       uploadcc.png\n|   |\n|   \\---js\n|           .DS_Store\n|           additional-methods.min.js\n|           index.php\n|           jquery-1.9.1.js\n|           jquery.js\n|           jquery.masked.js\n|           jquery.maskedinput.js\n|           jquery.payment.js\n|           jquery.validate.min.js\n|           validate.php\n|           validation.js\n|\n+---CrawlerDetect\n|   |   .DS_Store\n|   |   CrawlerDetect.php\n|   |   ReferralSpamDetect.php\n|   |\n|   \\---Fixtures\n|           AbstractProvider.php\n|           AbstractReff.php\n|           Crawlers.php\n|           Exclusions.php\n|           Headers.php\n|           Headerspam.php\n|           SpamReferrers.php\n|\n+---result\n|       index.php\n|\n+---security\n|       blacklist.dat\n|       index.php\n|       onetime.dat\n|       user.dat\n|       whitelist.dat\n|\n\\---upload\n        .htaccess\n        index.php\n")])])])]),e._v(" "),n("br"),e._v(" "),n("h3",{attrs:{id:"evasion"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#evasion"}},[e._v("#")]),e._v(" Evasion")]),e._v(" "),n("p",[e._v("FreakzBrothers utilises several methods to attempt to evade detection or being scanned by bots. These methods include;")]),e._v(" "),n("h4",{attrs:{id:"htaccess"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#htaccess"}},[e._v("#")]),e._v(" .htaccess")]),e._v(" "),n("p",[e._v("Within several directories a specially made Apache "),n("code",[e._v(".htaccess")]),e._v(" file redirects or blocks visitors based on attributes of the request. If the request appears to come from a known crawler, scanner or what would appear to not be a potential victim, it will redirect the browser to a legitimate URL.")]),e._v(" "),n("h4",{attrs:{id:"crawlerdetect"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#crawlerdetect"}},[e._v("#")]),e._v(" CrawlerDetect")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/JayBizzle/Crawler-Detect",target:"_blank",rel:"noopener noreferrer"}},[e._v("CrawlerDetect"),n("OutboundLink")],1),e._v(" is an open source tool written in PHP which aims to identify and stop known bots/crawlers/spiders based on the "),n("code",[e._v("user_agent")]),e._v(" and "),n("code",[e._v("http_from")]),e._v(" headers.")]),e._v(" "),n("h4",{attrs:{id:"antibot"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#antibot"}},[e._v("#")]),e._v(" Antibot")]),e._v(" "),n("p",[e._v("Antibot is a popular service for many PaaS kits that deserves a deep-dive all of it's own. The service provides an api which can be queried along with an ip. If the ip has been associated with a bot or service which crawls for malicious sites it will block the request and present the requester with a 403 http response.")]),e._v(" "),n("p",[e._v("As you can see from the below code taken from "),n("code",[e._v("blocker2.php")]),e._v(" it will check for the existence of an "),n("code",[e._v("antibot.ini")]),e._v(" file which should (if the user has paid for the service) contain an API key. If it exists, it allows the function "),n("code",[e._v("getUserIPszz()")]),e._v(" to be called which checks the IP against antibot and logs the details if it is blocked.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115612573-53ac2a80-a2e3-11eb-9f68-d77efc039025.png",alt:"image-17"}})]),e._v(" "),n("h4",{attrs:{id:"killbot"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#killbot"}},[e._v("#")]),e._v(" Killbot")]),e._v(" "),n("p",[e._v("Killbot is a recent addition to some versions of FreakzBrothers and is running as a direct competitor to antibot, touting additional functionality and cheaper costs. Killbot is present within the kit we are looking at, however I will be producing a separate write-up on this soon.")]),e._v(" "),n("h4",{attrs:{id:"proxyblock"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#proxyblock"}},[e._v("#")]),e._v(" Proxyblock")]),e._v(" "),n("p",[e._v("FreakzBrothers also utilises some PHP code alongside a third-party api hosted by mind-media.com which will check the visitor's IP against a list of known proxy and VPN IP ranges. If there's a match, the visitor is presented with a 403 http response and details are logged.")]),e._v(" "),n("h4",{attrs:{id:"parameters"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#parameters"}},[e._v("#")]),e._v(" Parameters")]),e._v(" "),n("p",[e._v("FreakzBrothers can utilise required arguments/parameters as part of a GET request when navigating to the phishing URL. This means that unless you know the param which is specified by the kit owner you will be unable to even reach the phishing page.")]),e._v(" "),n("p",[e._v("This is covered in more detail below.")]),e._v(" "),n("h3",{attrs:{id:"attack-phase"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#attack-phase"}},[e._v("#")]),e._v(" Attack phase")]),e._v(" "),n("h4",{attrs:{id:"clicking-the-link"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#clicking-the-link"}},[e._v("#")]),e._v(" Clicking the link")]),e._v(" "),n("p",[e._v("Attacks generally originate from an email purporting to be from Amazon asking the potential victim to check their account. Within these messages there will be a link to the malicious site which will be generally structured like "),n("code",[e._v("https://fakeamazon.domain.com/?param")]),e._v(" with the "),n("code",[e._v("param")]),e._v(" being specified within the configuration of the kit if this is enabled.")]),e._v(" "),n("p",[e._v("When clicking the URL and connecting to the site, the landing page ("),n("code",[e._v("index.php")]),e._v(") performs several checks depending on the kit configuration.")]),e._v(" "),n("p",[e._v('First of all, several other PHP files are included which are responsible for importing various functions and configuration options, then a check is performed to see if there are existing API keys present for antibot or killbot. Additional PHP scripts are also included to check the visitors IP against block lists, as well as the use of a "one time" function.')]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613110-ea78e700-a2e3-11eb-86c9-6f0b085f0f4d.png",alt:"image-24"}})]),e._v(" "),n("p",[e._v("The file "),n("code",[e._v("onetime.php")]),e._v(" includes several functions which if enabled, are there to ensure victims cannot visit the site again after entering their credentials.")]),e._v(" "),n("p",[e._v("Next the user agent and ISP of the requesting IP address are checked against address a word list, which returns a "),n("code",[e._v("403")]),e._v(" response or redirect to "),n("code",[e._v("amazon.com")]),e._v(" if there is a match.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613123-eea50480-a2e3-11eb-9410-9bb0d0deb7c1.png",alt:"image-25"}})]),e._v(" "),n("p",[e._v("The user agents and ISP's being blocked are commonly associated with web crawlers and VPS providers such as AWS and DigitalOcean. Any blocked request is then logged to "),n("code",[e._v("block_bot.txt")]),e._v(" and "),n("code",[e._v("total_bot.txt")])]),e._v(" "),n("p",[e._v('Access to the site can further be restricted via a "site password" or requiring a specific '),n("code",[e._v("GET")]),e._v(" parameter.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613213-0aa8a600-a2e4-11eb-9390-6e6254f841c3.png",alt:"image-26"}})]),e._v(" "),n("p",[e._v("If either of these options are enabled and the password/parameter is not correct, the visitor is redirected to "),n("code",[e._v("amazon.com")]),e._v(" and the request logged within "),n("code",[e._v("block_bot.txt")]),e._v(" and "),n("code",[e._v("total_bot.txt")]),e._v(".")]),e._v(" "),n("p",[e._v("If the request has provided the correct password or parameter, the visit is logged to "),n("code",[e._v("log_visitor.txt")]),e._v(" and "),n("code",[e._v("total_click.txt")]),e._v(" and the potential victim is then forwarded on to the first stage of the phishing attack.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613298-23b15700-a2e4-11eb-9e30-cd4135363f92.png",alt:"image-27"}}),n("br"),e._v(" "),n("em",[n("code",[e._v("$key")]),e._v(" is a SHA1 hash of a base64 encoded string consisting of the victims IP and user agent")])]),e._v(" "),n("p",[e._v("At this point in the phish, if the visitor has been identified as:")]),e._v(" "),n("ul",[n("li",[e._v("Not a bot")]),e._v(" "),n("li",[e._v("Not coming from a blacklisted IP")]),e._v(" "),n("li",[e._v("Not using a proxy/VPN service")]),e._v(" "),n("li",[e._v('Provided the correct "key"/parameter (generally from clicking on the URL from within a phishing email)')])]),e._v(" "),n("p",[e._v("They will be forwarded on to the phishing page.")]),e._v(" "),n("h4",{attrs:{id:"amazon-credentials"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#amazon-credentials"}},[e._v("#")]),e._v(" Amazon credentials")]),e._v(" "),n("p",[e._v('The first stage phishing page presented to the user is an exact clone of Amazon\'s own "sign in" page.')]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613484-58251300-a2e4-11eb-82d9-1ca7906043b1.png",alt:"image-28"}})]),e._v(" "),n("p",[e._v("Depending on the OS of the device connecting to the page, the potential victim may instead be presented with a mobile view of the page. We will be following these steps from a desktop OS however.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613565-725ef100-a2e4-11eb-9a5b-ca03b7ac6f7b.png",alt:"image-29"}})]),e._v(" "),n("p",[e._v("After supplying credentials and clicking submit, the information is posted to "),n("code",[e._v("login.php")]),e._v(" where several checks are made before proceeding.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613589-7be85900-a2e4-11eb-982c-f55258b750ee.png",alt:"image-38"}})]),e._v(" "),n("p",[e._v("These functions check that the provided email address and password are of sufficient length, and if the email provided is empty or belongs to a temporary mail service, the visitors IP is added to "),n("code",[e._v("onetime.dat")]),e._v(", where from then on "),n("code",[e._v("onetime.php")]),e._v(" will prevent them from visiting the site again.")]),e._v(" "),n("p",[e._v("If the information provided by the victim passes these checks, the information is collated and submitted to the exfil email address set by the owner of the deployment. The message would appear as below;")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('++++++++++++++++++++++++[ FREAKZBROTHERS V2.0 ]+++++++++++++++++++++++++++\n+--------------------------[ AMAZON ACCOUNT ]-------------------------+\n# ACCOUNT        : ".$_POST[\'emailLogin\']."\n# PASSWORD   : ".$_POST[\'passwordLogin\']."\n+--------------------------[ PC INFORMATION ]-------------------------+\n# IP ADDRESS     : ".$ip."\n# ISP                    : ".$ispuser."\n# REGION            : ".$regioncity."\n# CITY                 : ".$citykota."\n# CONTINENT      : ".$continent."\n# TIMEZONE        : ".$timezone."\n# DATE                : ".$date."\n# USER AGENT    : ".$user_agent."\n++++++++++++++++++++++++[ FREAKZBROTHERS V2.0 ]+++++++++++++++++++++++++++\n')])])]),n("p",[e._v("The IP of the victim is also logged to "),n("code",[e._v("total_login.txt")]),e._v(" before then being directed to "),n("code",[e._v("locked.php")]),e._v(".")]),e._v(" "),n("p",[e._v("At this stage depending on configuration, the victim is  informed their account has been locked, is suspended or needs to confirm an invoice, and that they are required to enter further information in order to resolve the issue.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613653-96223700-a2e4-11eb-869b-a2404f8e272e.png",alt:"image-30"}}),n("br"),e._v(" "),n("em",[e._v("Account locked message, one of multiple potential warnings the victim will get")])]),e._v(" "),n("p",[e._v('At this stage, when clicking "continue" the victim will either be directed straight to entering billing information, or if enabled, prompted to confirm their email credentials.')]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613724-acc88e00-a2e4-11eb-8e59-68386f2fdb6d.png",alt:"image-39"}})]),e._v(" "),n("p",[e._v("In this instance, "),n("code",[e._v("get_email")]),e._v(" is set to "),n("code",[e._v("IYA")]),e._v(" so we are directed to a copy of our mail providers login portal.")]),e._v(" "),n("h4",{attrs:{id:"email-credentials"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#email-credentials"}},[e._v("#")]),e._v(" Email Credentials")]),e._v(" "),n("p",[e._v("The "),n("code",[e._v("login_email.php")]),e._v(" file called determines what resources to load depending on the results of a regex match against the provided email address.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613762-bd790400-a2e4-11eb-9b02-cbd1137c52c8.png",alt:"image-40"}}),n("br"),e._v(" "),n("em",[e._v("Code which determines which fake email sign-in portal to present")])]),e._v(" "),n("p",[e._v("If there is no match (as in someone entered an email address associated with a domain not listed above), they are directed straight to the billing information stage.")]),e._v(" "),n("p",[e._v("In this example I entered a fake Gmail address, as such I have been directed to a fake Google account sign in page.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613821-c9fd5c80-a2e4-11eb-950c-234b3d7be33f.png",alt:"image-31"}})]),e._v(" "),n("p",[e._v("After the victim enters their email credentials, the password is stored within the "),n("code",[e._v("$_SESSION")]),e._v(" variable for later retrieval. The victim is then redirected back to an Amazon themed page and prompted for further information.")]),e._v(" "),n("h4",{attrs:{id:"billing-information"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#billing-information"}},[e._v("#")]),e._v(" Billing Information")]),e._v(" "),n("p",[e._v("The PHP file "),n("code",[e._v("billing.php")]),e._v(' is called and presented to the victim. This form requests for their billing information in order to "verify" their account. This form supports auto fill as well as providing drop down options for the country.')]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613893-e4cfd100-a2e4-11eb-95eb-03c6ca0c390e.png",alt:"image-32"}})]),e._v(" "),n("p",[e._v("Once all the fields have been populated this information is submitted via "),n("code",[e._v("POST")]),e._v(" to "),n("code",[e._v("card.php")]),e._v(" and the victim is taken to the next stage.")]),e._v(" "),n("h4",{attrs:{id:"credit-card-information"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#credit-card-information"}},[e._v("#")]),e._v(" Credit Card Information")]),e._v(" "),n("p",[e._v("All the information provided so far is "),n("code",[e._v("POST")]),e._v("'ed to this PHP file, and all information is saved to the "),n("code",[e._v("$_SESSION")]),e._v(" variable.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613933-f31ded00-a2e4-11eb-981e-059cc632a0b9.png",alt:"image-41"}})]),e._v(" "),n("p",[e._v("Note there are some fields we have not encountered in this process (e.g. Passport information, citizen ID etc), this appears to be version/region specific.")]),e._v(" "),n("p",[e._v("This next page asks the victim to enter their credit card information to continue verification. Again, these forms support auto fill.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115613958-fa44fb00-a2e4-11eb-82ad-57cc5e12f850.png",alt:"image-33"}})]),e._v(" "),n("p",[e._v("Once the victim has entered their card information, they may be asked to enter it for a second time depending on the configuration the threat actor has set. If "),n("code",[e._v("double_cc")]),e._v(" is enabled, they will receive the below prompt and have to re-enter their details.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614017-092bad80-a2e5-11eb-9541-19fe030c662f.png",alt:"image-34"}})]),e._v(" "),n("p",[e._v("This information is then sent via "),n("code",[e._v("POST")]),e._v(" to "),n("code",[e._v("updateBilling.php")]),e._v(" where several checks are then performed to validate the input from the victim.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614056-1779c980-a2e5-11eb-9d17-76bcd6f79ef1.png",alt:"image-43"}})]),e._v(" "),n("p",[e._v("In this block of code, the entered information is checked and the following outcomes may occur:")]),e._v(" "),n("ol",[n("li",[e._v("If the credit card number was blank, add the user to "),n("code",[e._v("onetime.dat")]),e._v(" and respond with "),n("code",[e._v("403")])]),e._v(" "),n("li",[e._v("If a credit card number is present call "),n("code",[e._v("validate_card()")]),e._v(" which performs a simple regex check to validate card type (VISA, Mastercard etc)")]),e._v(" "),n("li",[e._v("If the expiry year is less than 2019, add the user to "),n("code",[e._v("onetime.dat")]),e._v(" and respond with "),n("code",[e._v("403")])]),e._v(" "),n("li",[e._v('If the expiry month is greater than "12", add the user to '),n("code",[e._v("onetime.dat")]),e._v(" and respond with "),n("code",[e._v("403")])])]),e._v(" "),n("p",[e._v("All data entered so far is then collated in to another email which is sent to the exfil email address set within the kit configuration.")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('++++++++++++++++++++++++++++[ FREAKZBROTHERS ]+++++++++++++++++++++++++++\n++-------------------------[ AMAZON ACCOUNT ]------------------------++\n# Email \t\t\t:\t".`$_SESSION`[\'email\']."\n# Password \t\t:\t".`$_SESSION`[\'password\']."\n++--------------------------[ CREDIT CARD ]--------------------------++\n# Bank \t\t\t:\t".$bin["bank"]["name"]."\n# Type \t\t\t:\t".strtoupper($bin["scheme"])." - ".strtoupper($bin["type"])."\n# Level \t\t\t:\t".strtoupper($bin["brand"])."\n# Card Holder \t\t:\t".$_POST[\'ccname\']."\n# Card Number \t:\t".$_POST[\'ccno\']."\n# Expire Date \t\t:\t".$_POST[\'exp_bulan\']."/".$_POST[\'exp_tahun\']."\n# Cvv \t\t\t:\t".$_POST[\'cvv\']."\n# Amex CID \t\t:\t".$_POST[\'cid\']."\n# Account Number \t:\t".$_POST[\'acno\']."\n# Sort Code \t\t:\t".$_POST[\'sortcode\']."\n# Credit Limit \t\t:\t".$_POST[\'climit\']."\n# For Check \t\t:\t".$_POST[\'ccno\']."|".$_POST[\'exp_bulan\']."|".$_POST[\'exp_tahun\']."|".$_POST[\'cvv\']."\n++-----------------------------[ VBV JP ]---------------------------++\n# Card Password \t:\t".$_POST[\'passjp\']."\n# Web ID \t\t\t:\t".$_POST[\'cardid\']."\n++-----------------------------[ BILLING ]--------------------------++\n# Full Name \t\t:\t".`$_SESSION`[\'fullname\']."\n# Address \t\t:\t".`$_SESSION`[\'address\']."\n# City \t\t\t:\t".`$_SESSION`[\'city\']."\n# State \t\t\t:\t".`$_SESSION`[\'state\']."\n# Zip \t\t\t:\t".`$_SESSION`[\'zipcode\']."\n# Country \t\t:\t".`$_SESSION`[\'country\']."\n# DOB \t\t\t:\t".`$_SESSION`[\'dob\']."\n# Phone Number \t:\t".`$_SESSION`[\'phone\']."\n# Phone Carrier \t:\t".$phone[\'carrier\']."\n++----------------------------[ OTHER INFO ]-----------------------++\n# ID Number \t\t\t\t:\t".`$_SESSION`[\'numbid\']."\n# Civil ID \t\t\t\t\t:\t".`$_SESSION`[\'civilid\']."\n# Qatar ID \t\t\t\t:\t".`$_SESSION`[\'qatarid\']."\n# National ID \t\t\t\t:\t".`$_SESSION`[\'naid\']."\n# Citizen ID \t\t\t\t:\t".`$_SESSION`[\'naid\']."\n# Passport Number \t\t\t:\t".`$_SESSION`[\'passport\']."\n# Bank Access Number \t\t:\t".`$_SESSION`[\'bans\']."\n# Social Insurance Number \t:\t".`$_SESSION`[\'sin\']."\n# Social Security Number \t:\t".`$_SESSION`[\'ssn\']."\n# OSID Number \t\t\t:\t".`$_SESSION`[\'osidnumber\']."\n++----------------------------[ DEVICE INFO ]----------------------++\n# IP Address \t\t:\t".$ip."\n# ISP \t\t\t:\t".$ispuser."\n# Region \t\t\t:\t".$regioncity."\n# City \t\t\t:\t".$citykota."\n# Continent \t\t:\t".$continent."\n# Time Zone \t\t:\t".$timezone."\n# OS/Browser \t\t:\t".$os." / ".$br."\n# Date \t\t\t:\t".$date."\n# User Agent \t\t:\t".$user_agent."\n++++++++++++++++++++++++++++[ FREAKZBROTHERS ]+++++++++++++++++++++++++++\n')])])]),n("p",[e._v("At this point the victims IP is then also logged to "),n("code",[e._v("total_cc.txt")]),e._v(" and "),n("code",[e._v("total_bin.txt")]),e._v(".")]),e._v(" "),n("p",[e._v("The final step of this PHP script is to determine the next stage for the victim depending on the configuration.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614161-3d06d300-a2e5-11eb-8cf1-281459908237.png",alt:"image-44"}})]),e._v(" "),n("p",[e._v("In our example, "),n("code",[e._v("get_bank")]),e._v(' is set to "Yups" so we are directed to '),n("code",[e._v("bank.php")]),e._v(".")]),e._v(" "),n("h4",{attrs:{id:"bank-account-information"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#bank-account-information"}},[e._v("#")]),e._v(" Bank Account Information")]),e._v(" "),n("p",[e._v("The next stage of the attack asks the victim to verify their bank account information by populating the below form.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614196-4db74900-a2e5-11eb-83e2-3b30249694bf.png",alt:"image-35"}})]),e._v(" "),n("p",[e._v("This information is then submitted via "),n("code",[e._v("POST")]),e._v(" to "),n("code",[e._v("bank_acc.php")]),e._v(" and some code is executed based on the inputted data.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614227-5871de00-a2e5-11eb-9a24-74ebd9955b1f.png",alt:"image-45"}})]),e._v(" "),n("p",[e._v("This code checks if any of the form fields were empty, and if they were it adds the IP of the victim to "),n("code",[e._v("onetime.dat")]),e._v(" and responds with a "),n("code",[e._v("403")]),e._v(", meaning the victim will then be unable to visit the site again.")]),e._v(" "),n("p",[e._v("The victims information is then collated in to another email message to the exfil email address:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('+++++++++++++++++++++++++[ FREAKZBROTHERS ]+++++++++++++++++++++++\n++-----------------------[ BANK ACCOUNT ]----------------------++\n# Bank Account Name \t\t:\t".$_POST[\'bankname\']."\n# Bank Account Username \t:\t".$_POST[\'bankuser\']."\n# Bank Account Password \t:\t".$_POST[\'bankpass\']."\n# Bank Routing Number \t\t:\t".$_POST[\'routing\']."\n# Bank Account Number \t\t:\t".$_POST[\'accountnumber\']."\n# PIN Number \t\t\t\t:\t".$_POST[\'pin\']."\n++------------------------[ DEVICE INFO ]----------------------++\n# IP Address \t\t:\t".$ip."\n# ISP \t\t\t\t:\t".$ispuser."\n# Region \t\t\t:\t".$regioncity."\n# City \t\t\t:\t".$citykota."\n# Continent \t\t:\t".$continent."\n# Time Zone \t\t:\t".$timezone."\n# OS / Browser \t:\t".$os." / ".$br."\n# Date \t\t\t:\t".$date."\n# User Agent \t\t:\t".$user_agent."\n++++++++++++++++++++++++++[ FREAKZBROTHERS ]++++++++++++++++++++++\n')])])]),n("p",[e._v("The victims IP is then logged to "),n("code",[e._v("total_bank.txt")]),e._v(" and directed to either "),n("code",[e._v("verify_credit.php")]),e._v(" or "),n("code",[e._v("done.php")]),e._v(" depending on configuration.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614292-70496200-a2e5-11eb-84b1-425001bdb6f0.png",alt:"image-46"}})]),e._v(" "),n("h4",{attrs:{id:"photos"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#photos"}},[e._v("#")]),e._v(" Photos")]),e._v(" "),n("p",[e._v("If "),n("code",[e._v("get_photo")]),e._v(' is set to "Oks" then the victim is prompted to upload a photo of their card as another form of verification. This process exists is all known kits but the design is different depending on that targeted brand.')]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614328-7c352400-a2e5-11eb-880a-19649c224167.png",alt:"image-36"}})]),e._v(" "),n("p",[e._v("Once the images are selected and the victim clicks update, they are processed by "),n("code",[e._v("submit_upload_cc.php")]),e._v(" where the "),n("code",[e._v("content-type")]),e._v(" is checked and stored within a directory called "),n("code",[e._v("upload")]),e._v(" or "),n("code",[e._v("uploads")]),e._v(". Copies of these images are also sent to the threat actor via email as attachments.")]),e._v(" "),n("h4",{attrs:{id:"completion"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#completion"}},[e._v("#")]),e._v(" Completion")]),e._v(" "),n("p",[e._v("At this point each phase of the phish has been completed and the victim is directed to "),n("code",[e._v("done.php")]),e._v(', informing them that their "account has been recovered".')]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614392-940ca800-a2e5-11eb-8ca4-d84cb0553cd4.png",alt:"image-37"}})]),e._v(" "),n("p",[e._v("Then the victim is redirected to a legitimate Amazon sign in page.")]),e._v(" "),n("h3",{attrs:{id:"admin-panel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#admin-panel"}},[e._v("#")]),e._v(" Admin Panel")]),e._v(" "),n("h4",{attrs:{id:"logging-in"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#logging-in"}},[e._v("#")]),e._v(" Logging in")]),e._v(" "),n("p",[e._v('Over time the admin panel for FreakzBrothers has had a few iterations, with the "nerdface" (thanks '),n("a",{attrs:{href:"https://twitter.com/dave_daves",target:"_blank",rel:"noopener noreferrer"}},[e._v("@dave_daves"),n("OutboundLink")],1),e._v(") design being replaced for some time. Recently however it seems the majority of kits have this login panel design instead, opting for the cartoon image which appears to originate from "),n("code",[e._v("creative-tim.com")]),e._v("."),n("br"),e._v("\nLikely explanation is simply that the kit author took a template design from the source, leaving default images and icons in place.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614735-f2d22180-a2e5-11eb-94f9-23bc73394c16.png",alt:"image-compare_png"}}),n("br"),e._v(" "),n("em",[e._v('"FreakzBrothers X Amazon" panel (left), "Nerdface" panel (right)')])]),e._v(" "),n("p",[e._v("The panel is generally located at "),n("code",[e._v("/admin/login.php")]),e._v(". All panels prompt the user for an email address and password, which upon entry are checked against a Firebase instance under the control of the of author of FreakzBrothers.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614828-0c736900-a2e6-11eb-8771-19cc5bbf1e6b.png",alt:"image-23"}}),n("br"),e._v(" "),n("em",[e._v("Firebase config viewable within source of page")])]),e._v(" "),n("p",[e._v("Request made to Firebase instance (left), Error when entering incorrect details (right)\nIf the credentials are valid the user is then taken to the dashboard where they can administer the deployment or check recent activity.")]),e._v(" "),n("p",[e._v('This authentication also serves as a form of ensuring the user is "licensed" to use the kit, in an effort to keep distribution and use under the control of the original author.')]),e._v(" "),n("h4",{attrs:{id:"obfuscation"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#obfuscation"}},[e._v("#")]),e._v(" Obfuscation")]),e._v(" "),n("p",[e._v("The kit in of itself does not contain much in the way of obfuscation apart from the script under "),n("code",[e._v("/admin/login.php")]),e._v(". The code within this file has been altered by the now defunct MessPHP in order to try and dissuade alteration, however it is fairly trivial to get around this.")]),e._v(" "),n("p",[e._v("Obfuscated (left), Deobfuscated (right)\nDeobfuscating the PHP code of the login page reveals there is a hidden token form which allows bypassing of the username/password field by entering a key which is defined in "),n("code",[e._v("/admin/vendor/config.php")])]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614883-22812980-a2e6-11eb-95ed-784dc100d9e9.png",alt:"tokenform-1"}}),n("br"),e._v(" "),n("em",[e._v("Hidden token form")])]),e._v(" "),n("h4",{attrs:{id:"dashboard"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dashboard"}},[e._v("#")]),e._v(" Dashboard")]),e._v(" "),n("p",[e._v("Once authenticated the dashboard provides an overview of recent activity, statistics of victims and access to configuration data, antibot/killbot settings and the ability to reset local logs.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614919-2d3bbe80-a2e6-11eb-9b97-ec2ffd037f03.png",alt:"image-19"}})]),e._v(" "),n("p",[e._v("The statistic widgets contain a total count of entries from the appropriate logs. The visitor log section also contains an output of recent visits including timestamps, IP, country and OS information.")]),e._v(" "),n("p",[e._v("These log files (similarly to "),n("RouterLink",{attrs:{to:"/_posts/2020-07-31-16Shop-dissecting-the-slimy-phish.html"}},[e._v("16Shop")]),e._v(") are also exposed, allowing anyone to view the contents.")],1),e._v(" "),n("ul",[n("li",[n("code",[e._v("log_visitor.txt")]),e._v(" Contains IP and OS info of the victim, as well as a timestamp for each stage of the phish they reached")]),e._v(" "),n("li",[n("code",[e._v("total_bank.txt")]),e._v(" IP of victims who enter bank account credentials")]),e._v(" "),n("li",[n("code",[e._v("total_bin.txt")]),e._v(" BIN number and OS of victims which entered bank details")]),e._v(" "),n("li",[n("code",[e._v("total_bot.txt")]),e._v(" IP of any suspected bots which have been blocked")]),e._v(" "),n("li",[n("code",[e._v("total_cc.txt")]),e._v(" IP of each victim which entered CC info")]),e._v(" "),n("li",[n("code",[e._v("total_click.txt")]),e._v(" IP of anyone who accessed the phishing page with the correct "),n("code",[e._v("GET")]),e._v(" parameter")]),e._v(" "),n("li",[n("code",[e._v("total_email.txt")]),e._v(" IP of each victim which entered email credentials")]),e._v(" "),n("li",[n("code",[e._v("total_login.txt")]),e._v(" IP of each victim which submitted credentials")]),e._v(" "),n("li",[n("code",[e._v("total_photocc.txt")]),e._v(" IP of victims which uploaded CC photos")]),e._v(" "),n("li",[n("code",[e._v("total_photoid.txt")]),e._v(" IP of victims which uploaded photo ID")]),e._v(" "),n("li",[n("code",[e._v("total_vbv.txt")]),e._v(' IP of victims which passed "3D Secure" process')])]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115614992-48a6c980-a2e6-11eb-8ef8-9b460aac691a.png",alt:"image-21"}}),n("br"),e._v(" "),n("em",[e._v("An exposed log_visitor.txt file")])]),e._v(" "),n("h4",{attrs:{id:"settings"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#settings"}},[e._v("#")]),e._v(" Settings")]),e._v(" "),n("p",[e._v("This page contains the configuration data for the deployment, which is pulled from "),n("code",[e._v("main.php")]),e._v(" as well as giving the capability to change it on the fly. Entering or selecting the new option and clicking on "),n("code",[e._v("save")]),e._v(" updates the config, with these changes also reflected in "),n("code",[e._v("main.php")]),e._v(".")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115615062-5c523000-a2e6-11eb-93dd-4d6bcdffb753.png",alt:"image-20"}})]),e._v(" "),n("h4",{attrs:{id:"antibot-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#antibot-2"}},[e._v("#")]),e._v(" Antibot")]),e._v(" "),n("p",[e._v("This page allows for entry of antibot/killbot API keys. Pasting keys in to the appropriate input and clicking "),n("code",[e._v("update")]),e._v(" will test the key and then enable functionality of antibot or killbot checks against IP addresses accessing the site.")]),e._v(" "),n("p",[n("img",{attrs:{src:"https://user-images.githubusercontent.com/50568995/115615323-ba7f1300-a2e6-11eb-9efa-b77734891c35.png",alt:"image-22"}})]),e._v(" "),n("h3",{attrs:{id:"vulnerabilities"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vulnerabilities"}},[e._v("#")]),e._v(" Vulnerabilities")]),e._v(" "),n("p",[e._v("FreakzBrothers kits (in all versions I have looked at) contain the same set of vulnerabilities which allows "),n("strong",[e._v("full access to the panel and settings page with no authorisation")]),e._v('. As such, any unauthenticated individual could theoretically "take over" the deployment and divert credentials to a mailbox under their control.')]),e._v(" "),n("p",[e._v("It would also be possible for someone to simply script this process, and delete the exfil email address every time it is updated so no credentials are ever sent to the attacker. Or even change the parameter whenever it's corrected so potential victims clicking on the phishing URL won't even be able to reach the phish.")]),e._v(" "),n("p",[e._v("I don't know who would do that though. 🙃")]),e._v(" "),n("p",[e._v("There are also other vulnerabilities which exist in some versions of FreakzBrothers (including cracked versions) which are much more serious, however I will not be sharing details of these.")]),e._v(" "),n("h2",{attrs:{id:"indicators"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#indicators"}},[e._v("#")]),e._v(" Indicators")]),e._v(" "),n("p",[e._v("Below are some IoC's commonly associated with FreakzBrothers along with some Yara rules I have written which can be utilised to scan any kits you may have for identification.")]),e._v(" "),n("h3",{attrs:{id:"hashes"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hashes"}},[e._v("#")]),e._v(" Hashes")]),e._v(" "),n("p",[e._v("Below are some common hashes for FreakzBrothers kit zip files in their various forms and versions. This also includes commonly found cracked kits which have been re-branded. (SHA-256)")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("7D9C3837DF13669BE3846EAB09E55592E7C819D6010A51F868A2E13057DC81FE\nC482992E50616F7770EA8A8CECCB4C4F987E6B299A21EB91A1A3FB5D81EBF1F7\nA6ABCE22A0C1962BF535D3CBA0A1FF911E2FDE87E841B0A7060BC69049EB1159\n3BDCC110C7D0CE80F151D909DD9D3544D718C079012BE17D14D9171C395B129F\nC2831C26B2A2D3CD1360CBBD7B1D03B0297E2A4285B319FBE880CF6F5193F1C3\n709EDEED26E226D8BC6FFA3CCFA23223B3EF9E68B6D4D7B41B64F18131C5A51A\n399BD6325500039BDF9DC9E889A930035F67910CFC76775250AA901078FA7A19\nEB30834ED5DBD5407919E9A293BAF799F46FAFBE30D814111DBCB32A508FF834\n3B6112271B08BF205CF45FC9A289D6B886B93254002FBDD94EDCD0519E281D12\nF9E19640C808B44165A97F434B22B5417A5B5C0E44D163D5E0C40F027AEE1AE0\nC7E208B8605B1C76BED0FACED5DA9799D1C792AF08D3137BE19479495EB9BFAF\n30E17DC7D7A34353D357B7FD7B55E49F39C0A0B26CFA60EA24E66ECE573FB9A2\n86E33ED848A840658AEA66F7277F28620565DF1C82C82D9D84BE2082D09FE8AF\nF7F7E5F278813F964AAE50F173BE7218C888F800465A76FE413BC145423AD067\n58D5829E0FCAFADEB3615F675CFD7E10B928B6565098318CFF5B3027BC92F618\n9987DE1558A466DB6AFB511E83A008EA7DD75934635678860F7CC8CD21E44D63\n07F98D9C48AF76295D09C6C1BE5B25C7208E77A25D918C82C309D7894C306DD6\n6D6FC9886139D3DD3444552D437FB8A7C6854097C2088AF3BA2CCAE726E48DC4\n32F906A8F16993A8BB7194BBB4BCF8AC045C39DE36B7F5768F10ED4AE36387CB\n68F1C82B0D3FE33F957A3EC48296A164074AEE6964B11F1825E877AA9D7C1ACA\nA0816B994402386F5E94459EAEA9A24D6000E0ED87D3C14CBCB8D206DB3854D1\n6C0571ACCE5A723AB7F414FC909B1BB760F9C8B24FB38ED822970B8E573B0344\n21AFB0A54C50258B7FD00B6B220CC008D26D4A70E1E586100A0C374B4CD0F086\n96ADFBA4BC1F728EC01E5A4AC4B7E32B0E26C71E698AF5CFE6EC74827BC4B08B\nDAC94D25E4D246C48F12F09E82DD4FBFEA88B24DF5B318EB23FD1575BA97D215\n9FD2DF307D42B80ADD3D78533ABD587A31BE803F297D18248E02B59DEEB7E90D\n71CCF7BC6223F2F8EA36AB17DBCE764C0900AF4902521978EFE6588F5E3F8646\nED7EBE25F91FDD8DE7BB8805ECE349F72FFEE38530752F0AFFAE959D78B9B787\n0FC3EC0B1026FEFD53F76D04B19D2E41AC8CED3D1974E567DB5C047E601134E9\nCBBBC1C093AFACFCD1E6C4A3743629CE10E67833BA37A56B0EBF1A767845027C\nF94B04B040B35444816C25777D5C60CDB68744C962A734940DC27F3A03B5661C\n8C91484ABF0A9879C9528CB3309C1ABBEDDCA80DD0CB472F4F792FC4C09FCCED\n89C3B988D1CEB59C38F197FFD92826F92D3E910D736969BBA5801FB5C7C3D94D\n77EC37FE76531EA55443F9D02AF41C3E65279E71FF40CB99B799D699A380B258\nBE61B431401B154B2B4688A56857F1D66A1C3EAE9FC8ECE4D7FB87BC18D38FAD\nCBFCFABDE2CCA369692EC0ACA82D3BE1A7FC5F5E7EACF5C860C51C15E3706264\n2504B1AD951ABA44793AD68B3587C21AFE517D1FC023051FCD0F2AE9F8C3FFC2\n26265F134B077F976CB235CE980C0324D112F7FC8B14B9F2DB306E7B06711C35\nFEB89BC8D73D9D1E2855F92AAD2B1141533D5AF868EA60BDF4B8D92B5CB96391\n8BE164934937CDF1DBF015730DC20C4A4DA3FF6694666DC10DCBB43C8E4BF439\n0D7AFA91BA81AA96DC5DC4CDD07284A398BF542D5A26AA50B26481A3E7189B23\n8280B70E38C8C5E309B392B471665B19C254E5CC6FF796BE89333E20D267348E\n8BB42A65746C5EE40A120B2236235CB68713135AA52DF9B711EDEA9BB288812C\nD215895C334B314A699B5777E0C437A4771CF730424017CFB3B3635E325EC4FC\nC6BB7054803AD830BAD03F26DB6034791C5D6A46F3C342017C562BD5006D470D\n7A092A0C75537DC5C9F23EFC221B6E8B987F614ACA918D4D4B75559BA5A3FFB2\nABB3100FC013980E641185F7E481F489809FDB60B4AD54557032E543B6CFBEA5\nABB3100FC013980E641185F7E481F489809FDB60B4AD54557032E543B6CFBEA5\nDB6EC9C078EA8E71D13865D379991BEDD1BF3567E8A3ED525B2019E6BA939ACD\nC9634341CD8746110F72DB36A2EB7AFA890D3FC6D60489EA5C62F887C06B44BB\n219EDADF9F9BAF57E6D9452DF06C0E5C203386D7B7C277A0601331E6F784DF27\n928030EA6A8C657E20EF2140F0BDE56178CD7AA803898477D817B0939B24095A\n9FCA04FCFCD1A4F47AA1F0C646BD10589E89A384483F693B4EEBEBD05387B421\n60C6F05C7D06840CE0C5F21A501172B34DEEDF7FD32E7B7FF0FF993F57E92725\nE820B1D225C2F03CE1A9A35719D22CA1A19203ED5CAC1F6BBEDCE1EEC012B69C\nD4DDDE834BD2C7A1D5BC256530DD5CB4D9C310759A52B40B34A0FB90725050F1\nA471D6EB2790C369BEBFAB4779EF344D16E0145E92ECC124F244ED8218FB77FB\n60C91641C3A9AD00424EC51042A0DFC08451DBA5E6EF1ED6F323833504A49227\n6330BB94D326B871E4E13196C216FE2BB6423A1E9F4447C19B5E3FE363CE6502\n")])])]),n("h3",{attrs:{id:"ip-addresses"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ip-addresses"}},[e._v("#")]),e._v(" IP Addresses")]),e._v(" "),n("p",[e._v("These IP's have been commonly associated with FreakzBrothers deployments and should be treated with suspicion. Some are also associated with dynamic DNS providers.")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("52.229.207.24\n137.135.77.178\n13.77.201.14\n168.62.55.66\n104.223.143.106\n162.0.233.72\n64.235.45.62\n51.140.141.249\n162.241.121.240\n198.255.78.54\n199.192.16.182\n162.0.228.93\n162.241.121.193\n192.240.99.117\n52.183.36.7\n")])])]),n("h3",{attrs:{id:"yara-rules"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#yara-rules"}},[e._v("#")]),e._v(" YARA Rules")]),e._v(" "),n("p",[e._v("These rules can be ran against zip files or any repository of phishing kit zips to identify if they contain common artefacts of FreakzBrothers kits. The generic rule aims to capture any FreakzBrothers kit including cracked versions, whereas the specific rules will identify FreakzBrothers kits based on their targeted brand.")]),e._v(" "),n("details",[n("summary",[e._v("Generic")]),e._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('rule PhishKit_FreakzBrothers\n{\n    meta:\n        description = "Generic rule for FreakzBrothers kits"\n        author = "@sysgoblin"\n        date = "2020-07-18"\n        reference = ""\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "admin"\n        $dir2 = "result"\n        $conf_file1 = "conf.php"\n        $conf_file2 = "config.php"\n        $file1 = "setting.php"\n        $file2 = "antibot.php"\n        $file3 = "paper-dashboard.scss"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        all of ($dir*) and\n        1 of ($conf_file*) and\n        all of ($file*)\n}\n')])])])]),e._v(" "),n("br"),e._v(" "),n("details",[n("summary",[e._v("Amazon")]),e._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('rule PhishKit_FreakzBrothers_Amazon\n{\n    meta:\n        description = "Rule for FreakzBrothers kits targeting Amazon"\n        author = "@sysgoblin"\n        date = "2020-07-18"\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "admin"\n        $dir2 = "result"\n        $conf_file1 = "conf.php"\n        $conf_file2 = "config.php"\n        $file1 = "setting.php"\n        $file2 = "antibot.php"\n        $file3 = "paper-dashboard.scss"\n        $file4 = "amazon.png"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        all of ($dir*) and\n        1 of ($conf_file*) and\n        all of ($file*)\n}\n')])])])]),e._v(" "),n("br"),e._v(" "),n("details",[n("summary",[e._v("Apple")]),e._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('rule PhishKit_FreakzBrothers_Apple\n{\n    meta:\n        description = "Rule for FreakzBrothers kits targeting Apple"\n        author = "@sysgoblin"\n        date = "2020-07-18"\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "admin"\n        $dir2 = "result"\n        $conf_file1 = "conf.php"\n        $conf_file2 = "config.php"\n        $file1 = "setting.php"\n        $file2 = "antibot.php"\n        $file3 = "paper-dashboard.scss"\n        $icon1 = "icloud_icon.png"\n        $icon2 = "app-small.svg"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        all of ($dir*) and\n        1 of ($conf_file*) and\n        all of ($file*) and\n        ($icon1 or $icon2)\n}\n')])])])]),e._v(" "),n("br"),e._v(" "),n("details",[n("summary",[e._v("PayPal")]),e._v(" "),n("div",{staticClass:"language-yara extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('rule PhishKit_FreakzBrothers_PayPal\n{\n    meta:\n        description = "Rule for FreakzBrothers kits targeting PayPal"\n        author = "@sysgoblin"\n        date = "2020-07-18"\n\n    strings:\n        $zip = { 50 4b 03 04 }\n        $dir1 = "admin"\n        $dir2 = "result"\n        $dir3 = "security"\n        $dir4 = "myaccount"\n        $conf_file1 = "conf.php"\n        $conf_file2 = "config.php"\n        $file1 = "setting.php"\n        $file2 = "antibot.php"\n        $file3 = "paper-dashboard.scss"\n        $file4 = "user.dat"\n\n    condition:\n        uint32(0) == 0x04034b50 and\n        $zip and \n        all of ($dir*) and\n        1 of ($conf_file*) and\n        all of ($file*)\n}\n')])])])]),e._v(" "),n("br"),e._v(" "),n("h3",{attrs:{id:"feeds"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#feeds"}},[e._v("#")]),e._v(" Feeds")]),e._v(" "),n("p",[e._v("For a feed of recent FreakzBrothers detections and exfil emails, check out the api over at "),n("a",{attrs:{href:"https://phishingreel.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("phishingreel.io"),n("OutboundLink")],1)]),e._v(" "),n("h2",{attrs:{id:"credits"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#credits"}},[e._v("#")]),e._v(" Credits")]),e._v(" "),n("p",[e._v("Shout out to the legends below for keeping up the good fight!")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://twitter.com/dave_daves",target:"_blank",rel:"noopener noreferrer"}},[e._v("@dave_daves"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/JCyberSec_",target:"_blank",rel:"noopener noreferrer"}},[e._v("@JCyberSec_"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/nullcookies",target:"_blank",rel:"noopener noreferrer"}},[e._v("@nullcookies"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/aneilan",target:"_blank",rel:"noopener noreferrer"}},[e._v("@aneilan"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/steved3",target:"_blank",rel:"noopener noreferrer"}},[e._v("@steved3"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/n0p1ishing",target:"_blank",rel:"noopener noreferrer"}},[e._v("@n0p1ishing"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/kb_intel",target:"_blank",rel:"noopener noreferrer"}},[e._v("@kb_intel"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=i.exports}}]);